<?xml version="1.0"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>JBake</title>
    <link>https://guntherrotsch.github.io</link>
    <atom:link href="https://guntherrotsch.github.io/feed.xml" rel="self" type="application/rss+xml" />
    <description>JBake Bootstrap Template</description>
    <language>en-gb</language>
    <pubDate>Thu, 31 Dec 2020 11:51:52 +0100</pubDate>
    <lastBuildDate>Thu, 31 Dec 2020 11:51:52 +0100</lastBuildDate>

    <item>
      <title>Dependency Injection Without Framework</title>
      <link>https://guntherrotsch.github.io/blog_2020/di-without-framework.html</link>
      <pubDate>Thu, 31 Dec 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/di-without-framework.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_dependency_injection&quot;&gt;Dependency Injection&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Dependency injection (DI) is a Software design principle that rules to provide dependencies of a component (a.k.a. collaborators) independent of the component’s business logic, i.e. there’s a clear separation of the concerns&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;business logic&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;resolution of dependencies&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Dependency Injection also means, that the component is not responsible for the creation of components it depends on. Do get a better grip on these theoretical considerations, let’s look at some simplified sample code to illustrate the principle.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Without dependency injection a component could be defined like:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;public class Foo {

   private A a;
   private B b;

   public Foo() {
      this.a = new A();
   }

   public void bar() {
      C c = new C();
      c.doSomething();
   }
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The component &lt;code&gt;Foo&lt;/code&gt; depends on the components &lt;code&gt;A&lt;/code&gt;, &lt;code&gt;B&lt;/code&gt;, and &lt;code&gt;C&lt;/code&gt;. These depending components are created in the constructor respectively the (business) method &lt;code&gt;bar&lt;/code&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When introducing dependency injection the component’s definition could look like:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;public class Foo {

   private A a;
   private B b;
   private C c;

   public Foo(A a, B b, C c) {
      this.a = a;
      this.b = b;
      this.c = c;
   }

   public void bar() {
      c.doSomething();
   }
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The constructor takes instances of its collaborators, the business logic just relies on them. That separates behavior from dependency resolution. In simpler words, it allows the developer to define classes with specific functionality that depends on various collaborators, without having to define how reference to these collaborator will be obtained. In that way, decoupling among the various components is achieved and cleaner code is introduced in general.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Dependency injection also fosters the testability of the components. In particular, unit tests usually require that collaborators are mocked. With dependency injection as shown above, the mocked collaborators can be handed over to the constructor easily. In contrast, when the component creates its collaborators and hard-codes the dependencies, it’s nearly impossible to develop unit tests for the component.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_relation_to_inversion_of_control&quot;&gt;Relation to Inversion of Control&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Often Dependency Injection (DI) and Inversion of Control (IoC) are named at once. Are DI and IoC just a different name for the same thing? well, that’s not the case.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;IoC is a much broader concept, which says that the flow of control is reversed. Frameworks designed according to IoC follows the &lt;em&gt;Hollywood Principle&lt;/em&gt;, which is characterized by the statement &quot;Don’t call us, we’ll call you&quot;: Application code does not call the framework (as it would when using libraries), but the framework calls the application code appropriately. This design concept assists in the development of code with high cohesion and low coupling that is easier to debug, maintain and test.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Dependency injection is just a specific form of inversion of control where the concern being inverted is the process of obtaining the needed dependency.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_dependency_injection_frameworks&quot;&gt;Dependency Injection Frameworks&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In the introduction the mixing of software design principle and implementing technology was mentioned. And it’s true that Spring, Guice, CDI (to name just the most prominent DI frameworks) are in widespread use in projects.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;However, every framework used by a project creates a dependency that might make maintenance and migration of the developed application to another platform harder. For that reason, for small projects it could be an option to resign usage of a DI framework entirely.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Typical business applications follow a &lt;em&gt;Boundary-Control-Entity (BCE)&lt;/em&gt; design, in which case the boundary layer receives requests. In short, the boundary should host the assembling of all components that process the request. The assembled/created components gets their dependencies injected.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_types_of_dependency_injection&quot;&gt;Types of Dependency Injection&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Constructor injection as shown above is just one way to implement dependency injection. Dependency injection frameworks usually offers various options to inject dependencies, which are&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;constructor&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;field&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;setter&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;injection.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Which one to use is often subject of heated debates. But I recommend constructor injection for several reasons:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;it’s the most natural way to provide dependencies in a Java SE environment, i.e. &lt;strong&gt;not&lt;/strong&gt; using a framework&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;required dependencies are communicated to the user of the component by means of the Java language&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;it prevents collaborators from being left to &lt;code&gt;null&lt;/code&gt; and getting &lt;code&gt;NullPointerException&lt;/code&gt; at runtime (see link below)&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;the number of arguments passed into the constructor signals if a component depends on &lt;strong&gt;too many&lt;/strong&gt; collaborators (avoiding &quot;God&quot; classes) - can be easily checked by Sonarqube or other static code analysis tool&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;But, regardless which DI type you decide to use in your project, it’s crucial to design software with dependency injection in mind. The maintainer of your software will appreciate it very much - please keep in mind that this could be you :-).&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://www.martinfowler.com/articles/injection.html&quot;&gt;Martin Fowler: Inversion of Control Containers and the Dependency Injection pattern&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;http://olivergierke.de/2013/11/why-field-injection-is-evil/&quot;&gt;Oliver Gierke: Why field injection is evil&lt;/a&gt; ​&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Maven And The Classpath</title>
      <link>https://guntherrotsch.github.io/blog_2020/maven-classpath.html</link>
      <pubDate>Sun, 22 Nov 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/maven-classpath.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_maven_dependency_plugin&quot;&gt;Maven Dependency Plugin&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Have you ever wondered how the Maven setup classpath for test execution by Surefire looks like?&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Let’s start with an example. Given the sample project with the following dependencies, we’ll explore the setup of the classpath generated by Maven in detail:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn dependency:tree
[INFO] Scanning for projects...
[INFO]
[INFO] ---------------------&amp;lt; net.gunther.cli:json2yaml &amp;gt;----------------------
[INFO] Building json2yaml 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- maven-dependency-plugin:2.8:tree (default-cli) @ json2yaml ---
[INFO] net.gunther.cli:json2yaml:jar:0.0.1-SNAPSHOT
[INFO] +- javax.json:javax.json-api:jar:1.1:compile
[INFO] +- org.glassfish:javax.json:jar:1.1:compile
[INFO] \- org.junit.jupiter:junit-jupiter:jar:5.7.0:test
[INFO]    +- org.junit.jupiter:junit-jupiter-api:jar:5.7.0:test
[INFO]    |  +- org.apiguardian:apiguardian-api:jar:1.1.0:test
[INFO]    |  +- org.opentest4j:opentest4j:jar:1.2.0:test
[INFO]    |  \- org.junit.platform:junit-platform-commons:jar:1.7.0:test
[INFO]    +- org.junit.jupiter:junit-jupiter-params:jar:5.7.0:test
[INFO]    \- org.junit.jupiter:junit-jupiter-engine:jar:5.7.0:test
[INFO]       \- org.junit.platform:junit-platform-engine:jar:1.7.0:test
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The sample projects depends on the JSON-P API and its reference implementation by Glassfish. In addition, a dependency on the JUnit 5 test framework is defined. The sample project is my playground to get familiar with JSON-P functionality.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Maven Dependency plugin provides the simplest way to display the classpath:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn dependency:build-classpath
[INFO] Scanning for projects...
[INFO]
[INFO] ---------------------&amp;lt; net.gunther.cli:json2yaml &amp;gt;----------------------
[INFO] Building json2yaml 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- maven-dependency-plugin:2.8:build-classpath (default-cli) @ json2yaml ---
[INFO] Dependencies classpath:
/home/gunther/.m2/repository/javax/json/javax.json-api/1.1/javax.json-api-1.1.jar:/home/gunther/.m2/repository/org/glassfish/javax.json/1.1/javax.json-1.1.jar:/home/gunther/.m2/repository/org/junit/jupiter/junit-jupiter/5.7.0/junit-jupiter-5.7.0.jar:/home/gunther/.m2/repository/org/junit/jupiter/junit-jupiter-api/5.7.0/junit-jupiter-api-5.7.0.jar:/home/gunther/.m2/repository/org/apiguardian/apiguardian-api/1.1.0/apiguardian-api-1.1.0.jar:/home/gunther/.m2/repository/org/opentest4j/opentest4j/1.2.0/opentest4j-1.2.0.jar:/home/gunther/.m2/repository/org/junit/platform/junit-platform-commons/1.7.0/junit-platform-commons-1.7.0.jar:/home/gunther/.m2/repository/org/junit/jupiter/junit-jupiter-params/5.7.0/junit-jupiter-params-5.7.0.jar:/home/gunther/.m2/repository/org/junit/jupiter/junit-jupiter-engine/5.7.0/junit-jupiter-engine-5.7.0.jar:/home/gunther/.m2/repository/org/junit/platform/junit-platform-engine/1.7.0/junit-platform-engine-1.7.0.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Maven creates this classpath by considering the project’s dependencies. The reported classpath consists of references to JAR files cached in local Maven repository. Even the JAR artifact of the project is referenced from local Maven cache and not from the &lt;code&gt;/target&lt;/code&gt; directory one or the other might expect. This means that at least Maven’s &lt;code&gt;install&lt;/code&gt; lifecycle has to be executed before the dependency plugin is able to build the classpath correctly.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Please note, that transitive dependencies are included in the generated classpath, too.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Interestingly, the &lt;code&gt;dependency:build-classpath&lt;/code&gt; gives the &lt;em&gt;test classpath&lt;/em&gt;, ie. it also includes dependencies of scope &lt;code&gt;test&lt;/code&gt; and &lt;code&gt;provided&lt;/code&gt;. If you would like to know the classpath required for running the project’s application, the &lt;code&gt;includeScope&lt;/code&gt; option has to be set as System property like follows:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn dependency:build-classpath -DincludeScope=compile
[INFO] Scanning for projects...
[INFO]
[INFO] ---------------------&amp;lt; net.gunther.cli:json2yaml &amp;gt;----------------------
[INFO] Building json2yaml 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- maven-dependency-plugin:2.8:build-classpath (default-cli) @ json2yaml ---
[INFO] Dependencies classpath:
/home/gunther/.m2/repository/org/glassfish/javax.json/1.1/javax.json-1.1.jar:/home/gunther/.m2/repository/javax/json/javax.json-api/1.1/javax.json-api-1.1.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_maven_exec_plugin&quot;&gt;Maven Exec Plugin&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Maven’s exec plugin also makes a lot of use of the generated classpath. Because the exec plugin allows to execute the project’s application as defined by the POM, it’s not surprising that the required classpath is taken from Maven.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In the following, the &lt;code&gt;exec&lt;/code&gt; goal of the plugin is used. Even if the &lt;code&gt;java&lt;/code&gt; goal is sufficient to execute Java application, the &lt;code&gt;exec&lt;/code&gt; is sometimes beneficial because of:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Allows to execute non-Java applications&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Executes Java applications in its own JVM&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The exec plugin provides another way to display the Maven generated classpath:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn exec:exec -Dexec.executable=echo -Dexec.args=&quot;%classpath&quot;
[INFO] Scanning for projects...
[INFO]
[INFO] ---------------------&amp;lt; net.gunther.cli:json2yaml &amp;gt;----------------------
[INFO] Building json2yaml 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- exec-maven-plugin:3.0.0:exec (default-cli) @ json2yaml ---
/home/gunther/_work/java/json2yaml/target/classes:/home/gunther/.m2/repository/javax/json/javax.json-api/1.1/javax.json-api-1.1.jar:/home/gunther/.m2/repository/org/glassfish/javax.json/1.1/javax.json-1.1.jar
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In this case the &lt;code&gt;echo&lt;/code&gt; command is executed and displays the classpath passed in as &lt;code&gt;%classpath&lt;/code&gt; placeholder. The exec plugin substitutes this placeholder when starting the application.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Please note, that the classpath does not contain &lt;em&gt;test&lt;/em&gt; dependencies, but only reference artifacts actually required to execute the project’s application.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Another usage of the Maven generated classpath by exec plugin is to actually execute Java applications, eg.:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ echo &apos;{ &quot;f1&quot;: &quot;v1&quot;, &quot;f2&quot;: &quot;v2&quot; }&apos; | mvn exec:exec -Dexec.executable=java -Dexec.args=&quot;-cp %classpath net.gunther.cli.json.PrettyPrinter&quot;
[INFO] Scanning for projects...
[INFO]
[INFO] ---------------------&amp;lt; net.gunther.cli:json2yaml &amp;gt;----------------------
[INFO] Building json2yaml 0.0.1-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- exec-maven-plugin:3.0.0:exec (default-cli) @ json2yaml ---
{
    &quot;f1&quot;: &quot;v1&quot;,
    &quot;f2&quot;: &quot;v2&quot;
}
[INFO] ------------------------------------------------------------------------
[INFO] BUILD SUCCESS
[INFO] ------------------------------------------------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In this case the &lt;code&gt;java&lt;/code&gt; executable is started, which requires the classpath to be given as &lt;code&gt;-cp %classpath&lt;/code&gt; option. The placeholder is again substituted by references to the project’s dependencies.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The input string &lt;code&gt;{ &quot;f1&quot;: &quot;v1&quot;, &quot;f2&quot;: &quot;v2&quot; }&lt;/code&gt; is piped to the JSON pretty-printer demo application using &lt;code&gt;STDIN&lt;/code&gt;, the application writes given JSON in beautified format to &lt;code&gt;STDOUT&lt;/code&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The classpath generated by Maven can be beneficially used in developer’s environments as demonstrated above. The dependencies of the project’s POM are considered and dependencies added to the project are automatically make their way into the generated classpath - really cool.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;However, this approach is not suitable for the packaged application, because Maven is typically not available in the target runtime environment of an application. Such use cases are better implemented by packaging as single JAR that contains all dependencies. Alternatively, techniques described in my last Blog &lt;a href=&quot;https://guntherrotsch.github.io/blog_2020/executable-java-scripting.html&quot;&gt;Executable Scripts with Java&lt;/a&gt; or approaches like &lt;code&gt;jbang&lt;/code&gt; may be applied - the &lt;code&gt;jbang&lt;/code&gt; project is in a very early state, but looks promising.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://maven.apache.org/&quot;&gt;Maven project&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://www.mojohaus.org/exec-maven-plugin/&quot;&gt;Maven Exec Plugin&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://www.jbang.dev/&quot;&gt;jbang.dev project&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Executable Scripts with Java</title>
      <link>https://guntherrotsch.github.io/blog_2020/executable-java-scripting.html</link>
      <pubDate>Tue, 20 Oct 2020 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">blog_2020/executable-java-scripting.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_running_java_from_source&quot;&gt;Running Java from Source&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Since Java 11 the &lt;code&gt;java&lt;/code&gt; command does have the &lt;code&gt;--source&lt;/code&gt; option, which allows running Java code which is given in source. For demonstration purposes I’m using a Java 13 installation, but the sample will work with all Java versions &amp;gt;11.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ java -version
openjdk version &quot;13.0.1&quot; 2019-10-15
OpenJDK Runtime Environment (build 13.0.1+9)
OpenJDK 64-Bit Server VM (build 13.0.1+9, mixed mode, sharing)&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When the &lt;code&gt;--source&lt;/code&gt; feature is combined with the &lt;a href=&quot;https://en.wikipedia.org/wiki/Shebang_(Unix)&quot;&gt;Shebang&lt;/a&gt; of modern shells like so:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ cat hellojava.sh
#!/home/gunther/.jenv/shims/java --source 11
public class App {
    public static void main(String ...args){
        System.out.println(&quot;Hello, Java!&quot;);
    }
}&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;the file - given Posix file attributes include execute permission - can be executed like a shell script:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ ./hellojava.sh
Hello, Java!&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Java is still a compiled language, ie. before the &lt;em&gt;script&lt;/em&gt; starts, the Java compiler still need to generate the byte-code to be executed. This impacts the startup time of large scripts - Java applications are in general not known for starting quickly. Nevertheless, the &lt;code&gt;--source&lt;/code&gt; option allows more use cases implemented with Java.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sidebarblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;div class=&quot;title&quot;&gt;
     jenv
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;The one or the other may be wondering about the java command of the &lt;em&gt;Shebang&lt;/em&gt; definition. It actually points to the &lt;a href=&quot;https://github.com/jenv/jenv&quot;&gt;jenv&lt;/a&gt; tool, which eases management of multiple Java installations in parallel. Generally, the &lt;em&gt;Shebang&lt;/em&gt; command should the absolute path printed out by the &lt;code&gt;which&lt;/code&gt; command:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;literalblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre&gt;$ which java
/home/gunther/.jenv/shims/java

$ jenv version
openjdk64-13.0.1 (set by /home/gunther/.jenv/version)&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;If you’re looking for a more portable &lt;em&gt;Shebang&lt;/em&gt; definition, you could apply the &lt;code&gt;env&lt;/code&gt; command as follows:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;literalblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre&gt;#!/usr/bin/env -S java --source 11
...&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;This definition executes the Java installation (first) found in the &lt;code&gt;PATH&lt;/code&gt;, ie. the default Java installation on the system, regardless the installation directory.&lt;/p&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_before_java_version_11&quot;&gt;Before Java Version 11&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;It becomes less relevant with every day, but there are still organizations supporting legacy systems that run on Java 8. In such a environment the &lt;code&gt;--source&lt;/code&gt; option is not available. Nevertheless, there’s still a way to package Java applications into an executable file.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Let’s switch to Java 8 (thanks to &lt;code&gt;jenv&lt;/code&gt; this is a piece of cake :-):&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ java -version
openjdk version &quot;1.8.0_222&quot;
OpenJDK Runtime Environment (AdoptOpenJDK)(build 1.8.0_222-b10)
OpenJDK 64-Bit Server VM (AdoptOpenJDK)(build 25.222-b10, mixed mode)&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Java application is the same as before, just placed into a separate file which follows the Java naming convention, ie. file name equals class name.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ cat HelloJava.java

public class HelloJava {

	public static void main(String[] args) {
		System.out.println(&quot;Hello, Java!&quot;);
	}
}
$ javac -version
javac 1.8.0_222

$ javac HelloJava.java&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Note, that for sake of simplicity the Java source and class files are in the current working directory, ie. the class belongs to the default package. But the demonstrated approach will work for any Java package structure.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In the next step the compiled class is packaged into a JAR file:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ cat manifest.txt
Main-Class: HelloJava
$ jar cvfm hellojava.jar manifest.txt HelloJava.class
added manifest
adding: HelloJava.class(in = 424) (out= 287)(deflated 32%)&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Note, that the JAR’s manifest defines the &lt;code&gt;HelloJava&lt;/code&gt; class as entry point for execution.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Packaged the application as described, the executable can be created by the following commands:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;$ echo &apos;#!/home/gunther/.jenv/shims/java -jar&apos; &amp;gt;hellojava8.sh
$ cat hellojava.jar &amp;gt;&amp;gt;hellojava8.sh
$ chmod +x hellojava8.sh
$ ./hellojava8.sh
Hello, Java!
$&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Instead of placing the source code into the body of the shell script, the JAR file itself is appended to the &lt;em&gt;Shebang&lt;/em&gt; line, on which the &lt;code&gt;--source&lt;/code&gt; is replaced by the &lt;code&gt;-jar&lt;/code&gt; option.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Though, the steps to create the &lt;em&gt;executable&lt;/em&gt; Java application can be automated, the scripting experience gets partly lost by the need to explicitly compile and package the Java classes. On the other hand, the startup time is better compared to the source approach.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://github.com/jenv/jenv&quot;&gt;jenv&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Cloud-native Java with Quarkus</title>
      <link>https://guntherrotsch.github.io/blog_2020/quarkus-first-steps.html</link>
      <pubDate>Fri, 21 Aug 2020 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">blog_2020/quarkus-first-steps.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;There are many reasons to take a look at the &lt;a href=&quot;https://quarkus.io&quot;&gt;Quarkus&lt;/a&gt; framework. But beside its design for &lt;em&gt;developer friendliness&lt;/em&gt;, Quarkus focuses consequently onto cloud platforms, it’s perfectly suited for particular container orchestrators like Kubernetes or OpenShift. Compared to classical JEE platforms the benefits of Quarkus are:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;fast application startup by moving annotation processing from run-time to build-time&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;simplified packaging with just a single JAR file&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;small application and container image size&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;native images possible by GraalVM support&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Quarkus framework consists of a small core, to which arbitrary APIs can be added by extensions. Beside proprietary APIs, the most JEE and MicroProfife APIs are available within the Quarkus ecosystem. That makes Quarkus a perfect candidate for moving JakartaEE applications to the cloud.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;As a sample project I wanted to implement a simplified chat application. Users visiting the chat room can submit messages to the server that get distributed to all other users of the chat-room.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because JakartaEE Server-Sent Events (SSE) API are a perfect fit to distribute small pieces of information from a server to one or many clients, the Proof-of-Concept (PoC) project should demonstrate that SSE is eligible to implement a chat application. For the distribution of a message to many receivers the broadcast feature of SSE will be used.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_getting_started&quot;&gt;Getting Started&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Similar to &lt;a href=&quot;https://start.spring.io&quot;&gt;Spring initializr&lt;/a&gt; or &lt;a href=&quot;https://thorntail.io/generator/&quot;&gt;Thorntail Project Generator&lt;/a&gt; Quarkus offers a &lt;a href=&quot;https://code.quarkus.io/&quot;&gt;Start Coding&lt;/a&gt; page that let you pick the desired dependencies/APIs and generates a starter project that is downloaded as ZIP archive on demand. Alternatively, the starter project can be generated by instantiating a Maven archetype.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;For my PoC project I just picked &lt;em&gt;RESTEasy JAX-RS&lt;/em&gt; as extension, which automatically includes CDI. The generated starter project contained:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Sample JAX/RS resource&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Sample static content&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Maven POM and Maven wrapper script&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Dockerfiles for different types of packages (OpenJDK, native GraalVM, etc.)&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;After extracting the generated project setup, the project can already be executed by the Quarkus&apos; development server:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ ./mvnw quarkus:dev
[INFO] Scanning for projects...
[INFO]
[INFO] --------------------&amp;lt; net.gunther:quarkus-chat-sse &amp;gt;--------------------
[INFO] Building quarkus-chat-sse 0-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- quarkus-maven-plugin:1.6.1.Final:dev (default-cli) @ quarkus-chat-sse ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 4 resources
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 3 source files to /home/gunther/_work/repos/GuntherRotsch.github.com/guntherrotsch.github.io/code/quarkus-chat-sse/target/classes
Listening for transport dt_socket at address: 5005
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&amp;lt; / /_/contai /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2020-08-16 18:08:01,293 INFO  [io.quarkus] (Quarkus Main Thread) quarkus-chat-sse 0-SNAPSHOT on JVM (powered by Quarkus 1.6.1.Final) started in 1.509s. Listening on: http://0.0.0.0:8080
2020-08-16 18:08:01,309 INFO  [io.quarkus] (Quarkus Main Thread) Profile dev activated. Live Coding activated.
2020-08-16 18:08:01,309 INFO  [io.quarkus] (Quarkus Main Thread) Installed features: [cdi, qute, resteasy, resteasy-jsonb, resteasy-qute]&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Browsers can directly navigate to the &lt;a href=&quot;http://localhost:8080&quot;&gt;Quarkus Development server&lt;/a&gt;. Hence, the project setup is complete and empowers developers to start immediately implementing their application.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;One feature of the development server I’d like to highlight: Modified project code is immediately deployed. Even when dependencies defined in the POM change the re-built application gets &lt;strong&gt;hot-deployed&lt;/strong&gt; - what JRebel used to do in the past, can Quarkus already out-of-the-box, really cool.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_message_distribution_by_sse&quot;&gt;Message Distribution by SSE&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The client of the chat application is implemented using HTML and JavaScript. Thanks to Quarkus&apos; built-in feature to serve static content, the HTML files just need to be added to the &lt;code&gt;src/main/resources/META-INF/resources/&lt;/code&gt; folder. An &lt;code&gt;index.html&lt;/code&gt; file hosted in this folder can be fetched by a Browser from &lt;code&gt;&lt;a href=&quot;http://localhost:8080/&quot; class=&quot;bare&quot;&gt;http://localhost:8080/&lt;/a&gt;&lt;/code&gt; or &lt;code&gt;&lt;a href=&quot;http://localhost:8080/index.html&quot; class=&quot;bare&quot;&gt;http://localhost:8080/index.html&lt;/a&gt;&lt;/code&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The core logic of the client consists of:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;registering an &lt;code&gt;EventSource&lt;/code&gt; to receive chat messages as events&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;transmitting messages users typed in to the server, which distributes it to the other clients as Server-Sent Events&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Here are the most important pieces of the client’s code:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;&amp;lt;div id=&quot;history&quot;&amp;gt;&amp;lt;/div&amp;gt; &lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;

&amp;lt;textarea id=&quot;inputbox&quot; name=&quot;inputbox&quot;&amp;gt;&amp;lt;/textarea&amp;gt; &lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
&amp;lt;button id=&quot;submitButton&quot;&amp;gt;Submit&amp;lt;/button&amp;gt;

&amp;lt;script&amp;gt;
  const evtSource = new EventSource(&quot;/chat?name={name}&quot;); &lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
evtSource.onmessage = function(event) {
  console.log(&quot;Received event: &quot;, event);
    const newElement = document.createElement(&quot;li&quot;);
    const historyList = document.getElementById(&quot;history&quot;);

  newElement.innerHTML = &quot;message: &quot; + event.data;
    historyList.appendChild(newElement);
}
evtSource.onerror = function(event) {
  console.error(&quot;EventSource error: &quot;, event);
}

document.getElementById(&quot;submitButton&quot;).onclick = function() { &lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;(4)&lt;/b&gt;
  const message = document.getElementById(&quot;inputbox&quot;).value;

  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 &amp;amp;&amp;amp; this.status == 200) {
      alert(this.responseText);
    }
  };
  xhttp.open(&quot;POST&quot;, &quot;/chat&quot;, true);
  xhttp.setRequestHeader(&quot;Content-type&quot;, &quot;text/plain&quot;);
  xhttp.send(message);
}
&amp;lt;/script&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;colist arabic&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;The list of user messages received from as SSE. Whenever a new event occurs the message is appended to the list (see &amp;lt;3&amp;gt;).&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;Text area users inputs messages.&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;The registration of the &lt;code&gt;EventSource&lt;/code&gt; on the server. The &lt;code&gt;EventSource&lt;/code&gt; is a standard HTML5/JavaScript API implemented by all Browsers nowadays. Given proper registration on the server-side, SSEs are received by the &lt;code&gt;EventSource#onmessage&lt;/code&gt; function.&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;4&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;The function to submit messages to be send to the other users of the chat-room.&lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The JavaScript code to register is automatically executed on load of the page.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The server also implements 2 parts of logic:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;registration of clients which enters the chat-room&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;distribution of messages sent by users to all registered clients as SSE&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Java code is also stripped down to the crucial parts here:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;@ApplicationScoped
@Path(&quot;/chat&quot;)
public class ChatResource {

	private static final Logger LOGGER = LoggerFactory.getLogger(ChatResource.class);

	private SseBroadcaster sseBroadcaster; &lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;(1)&lt;/b&gt;
	private Sse sse;

	@Context
	public synchronized void setSse(Sse sse) { &lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;(2)&lt;/b&gt;
		if (this.sse != null) {
			return;
		}
		this.sse = sse;
		this.sseBroadcaster = sse.newBroadcaster();
		this.sseBroadcaster.onClose(eventSink -&amp;gt; LOGGER.info(&quot;On close EventSink: {}&quot;, eventSink));
		this.sseBroadcaster.onError(
				(eventSink, throwable) -&amp;gt; LOGGER.info(&quot;On Error EventSink: {}, Throwable: {}&quot;, eventSink, throwable));
	}

	@GET &lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;(3)&lt;/b&gt;
	@Produces(MediaType.SERVER_SENT_EVENTS)
	public void register(@Context SseEventSink eventSink, @QueryParam(&quot;name&quot;) String name) {
		LOGGER.info(&quot;Registering user: {}&quot;, name);
		sseBroadcaster.register(eventSink);
		eventSink.send(sse.newEvent(String.format(&quot;Welcome, %s!&quot;, name)));
		broadcast(String.format(&quot;%s entered the chat room...&quot;, name));
	}

	@POST &lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;(4)&lt;/b&gt;
	public void broadcast(String message) {
		OutboundSseEvent event = sse.newEventBuilder().data(message).reconnectDelay(10000).build();
		sseBroadcaster.broadcast(event);
	}
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;colist arabic&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;1&quot;&gt;&lt;/i&gt;&lt;b&gt;1&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;The &lt;code&gt;Sse&lt;/code&gt; and &lt;code&gt;SseBroadcaster&lt;/code&gt; objects are standard JAX-RS types. Because these objects are thread-safe, they can after initialization (see &lt;code&gt;ChatResource#setSse&lt;/code&gt; method) be used without synchronization.&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;2&quot;&gt;&lt;/i&gt;&lt;b&gt;2&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;Although the JAX-RS resource is &lt;code&gt;@ApplicationScoped&lt;/code&gt;, the &lt;code&gt;Context&lt;/code&gt; will be injected on every call. That makes sense because the context can be different on every call, even if the JAX-RS resource is a singleton. However, the initialization of instance variables &lt;code&gt;Sse&lt;/code&gt; and &lt;code&gt;SseBroadcast&lt;/code&gt; has to be performed only once. Otherwise, the registrations of clients get due to the re-initialization lost on every request. Hence, the &lt;code&gt;setSse&lt;/code&gt; injection method is synchronized and keeps the already existing initialization.&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;3&quot;&gt;&lt;/i&gt;&lt;b&gt;3&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;When users enter the chat-room, the client sends a registration to this method, which &lt;code&gt;@Produces&lt;/code&gt; messages of server-sent event type. Newly registered users are announced to the other visitors of the chat-room by a broadcast message.&lt;/td&gt; 
     &lt;/tr&gt; 
     &lt;tr&gt; 
      &lt;td&gt;&lt;i class=&quot;conum&quot; data-value=&quot;4&quot;&gt;&lt;/i&gt;&lt;b&gt;4&lt;/b&gt;&lt;/td&gt; 
      &lt;td&gt;The messages typed in by users and submitted to the servers get broadcasted to all registered users by this method.&lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because users should give their name on registration, the code for entering the chartroom is implemented as template, that injects the user’s name. For templating the &lt;strong&gt;Qute&lt;/strong&gt; extension has been added to the project, which turned out to be simple and straightforward. The entire code of the project is hosted in &lt;a href=&quot;https://github.com/GuntherRotsch/guntherrotsch.github.io/tree/code/quarkus-chat-sse&quot;&gt;the &lt;code&gt;code&lt;/code&gt; branch of the Blog repo&lt;/a&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_containerization&quot;&gt;Containerization&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;So far, we looked only at the development server. The following command will create an executable single JAR:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ ./mvnw clean install
$ ll target
...
-rw-rw-r--  1 gunther gunther 285458 Aug 17 19:16 quarkus-chat-sse-0-SNAPSHOT-runner.jar
...

$ java -jar target/quarkus-chat-sse-0-SNAPSHOT-runner.jar
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&amp;lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2020-08-17 17:17:23,707 INFO  [io.quarkus] (main) quarkus-chat-sse 0-SNAPSHOT on JVM (powered by Quarkus 1.6.1.Final) started in 1.261s. Listening on: http://0.0.0.0:8080
2020-08-17 17:17:23,757 INFO  [io.quarkus] (main) Profile prod activated.
2020-08-17 17:17:23,758 INFO  [io.quarkus] (main) Installed features: [cdi, qute, resteasy, resteasy-jsonb, resteasy-qute]
2020-08-17 17:17:41,886 INFO  [io.quarkus] (main) quarkus-chat-sse stopped in 0.041s
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Compared to classical application server deployments it’s already noticeable that&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;memory foot-print is small: 200 KB + JDK runtime, but no application server installation required&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;application starts up very fast: about 1 second on my a bit out-dated laptop; simple JAX-RS applications take due to classpath-scanning on Wildfly 19 about 10 seconds&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;This features already emphasize that Quarkus is suitable for cloud deployments.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In the following, we take an look at how Quarkus supports creating application containers, but leave apart the ability to create native GraalVM images, which might be an extra Blog post in the future.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_installing_jib_extension&quot;&gt;Installing jib extension&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;Quarkus supports 3 different ways to build container image:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;ulist&quot;&gt; 
    &lt;ul&gt; 
     &lt;li&gt; &lt;p&gt;Docker (requires a local Docker installation)&lt;/p&gt; &lt;/li&gt; 
     &lt;li&gt; &lt;p&gt;jib&lt;/p&gt; &lt;/li&gt; 
     &lt;li&gt; &lt;p&gt;S2I by fabric8&lt;/p&gt; &lt;/li&gt; 
    &lt;/ul&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The extension for &lt;code&gt;jib&lt;/code&gt; support can be added to the project by submitting the following command:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;gunther@gunther-K501UQ:~/_work/repos/GuntherRotsch.github.com/guntherrotsch.github.io/code/quarkus-chat-sse$ ./mvnw quarkus:add-extension -Dextensions=&quot;container-image-jib&quot;
[INFO] Scanning for projects...
[INFO]
[INFO] --------------------&amp;lt; net.gunther:quarkus-chat-sse &amp;gt;--------------------
[INFO] Building quarkus-chat-sse 0-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
[INFO]
[INFO] --- quarkus-maven-plugin:1.6.1.Final:add-extension (default-cli) @ quarkus-chat-sse ---
Downloading from central: https://repo.maven.apache.org/maven2/org/jboss/shrinkwrap/shrinkwrap-depchain/1.2.6/shrinkwrap-depchain-1.2.6.json
Downloading from central: https://repo.maven.apache.org/maven2/org/jboss/shrinkwrap/shrinkwrap-depchain-descriptor-json/1.2.6/shrinkwrap-depchain-descriptor-json-1.2.6.json
Downloading from central: https://repo.maven.apache.org/maven2/io/vertx/vertx-rx/3.9.1/vertx-rx-3.9.1.json
...&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_building_the_image&quot;&gt;Building the image&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;After installing the &lt;code&gt;jib&lt;/code&gt; extension, the following command builds the image:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;gunther@gunther-K501UQ:~/_work/repos/GuntherRotsch.github.com/guntherrotsch.github.io/code/quarkus-chat-sse$ ./mvnw clean package -Dquarkus.container-image.build=true
[INFO] Scanning for projects...
[INFO]
[INFO] --------------------&amp;lt; net.gunther:quarkus-chat-sse &amp;gt;--------------------
[INFO] Building quarkus-chat-sse 0-SNAPSHOT
[INFO] --------------------------------[ jar ]---------------------------------
...&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The built image is based on the lean Alpine Linux. However, distroless base images might be an alternative.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The image can be started as usual by:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;gunther@gunther-K501UQ:~/_work/repos/GuntherRotsch.github.com/guntherrotsch.github.io/code/quarkus-chat-sse$ docker run -it --rm gunther/quarkus-chat-sse:0-SNAPSHOT
__  ____  __  _____   ___  __ ____  ______
 --/ __ \/ / / / _ | / _ \/ //_/ / / / __/
 -/ /_/ / /_/ / __ |/ , _/ ,&amp;lt; / /_/ /\ \
--\___\_\____/_/ |_/_/|_/_/|_|\____/___/
2020-08-17 17:17:23,707 INFO  [io.quarkus] (main) quarkus-chat-sse 0-SNAPSHOT on JVM (powered by Quarkus 1.6.1.Final) started in 1.261s. Listening on: http://0.0.0.0:8080
2020-08-17 17:17:23,757 INFO  [io.quarkus] (main) Profile prod activated.
2020-08-17 17:17:23,758 INFO  [io.quarkus] (main) Installed features: [cdi, qute, resteasy, resteasy-jsonb, resteasy-qute]
^C2020-08-17 17:17:41,886 INFO  [io.quarkus] (main) quarkus-chat-sse stopped in 0.041s


gunther@gunther-K501UQ:~/_work/repos/GuntherRotsch.github.com/guntherrotsch.github.io/code/quarkus-chat-sse$ docker images
REPOSITORY                                                         TAG                       IMAGE ID            CREATED              SIZE
gunther/quarkus-chat-sse                                           0-SNAPSHOT                265891dea59b        About a minute ago   200MB
...&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The startup time is still about 1 second and the image size is about 200 MB for our sample application utilizing JAX-RS, CDI, and Templating. That’s really impressive, if you compare it with application server based setups, which result to my experience in images sizes of roughly:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;ulist&quot;&gt; 
    &lt;ul&gt; 
     &lt;li&gt; &lt;p&gt;JAX-RS service application &amp;amp; Wildlfly &amp;amp; OpenJDK: 750 MB&lt;/p&gt; &lt;/li&gt; 
     &lt;li&gt; &lt;p&gt;JAX-RS service application &amp;amp; Thorntail &amp;amp; OpenJDK: 400 MB&lt;/p&gt; &lt;/li&gt; 
    &lt;/ul&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The native GraalVM image of the Quarkus application would even be considerably smaller.&lt;/p&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_summary&quot;&gt;Summary&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The developer experience of Quarkus is incredible: Easy project setup and short development cycles due to hot-deployment with development server. In addition, Quarkus is well documented and actively supported by the community. The APIs offered by extensions do not miss anything. No wonder that the popularity of Quarkus arose to almost the level of Spring Boot within just 2 years.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In addition, the cloud-related properties are impressive, in regard to both, the image size as well as the startup time. Now even for Server-less deployment targets Java applications can considered without bad conscience.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Furthermore, the availability of Quarkus extensions of JEE/Jakarta EE APIs makes it a perfect candidate for migration of standard Java EE applications into the cloud.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://quarkus.io&quot;&gt;Quarkus&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://code.quarkus.io/&quot;&gt;Start Coding&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://start.spring.io&quot;&gt;Spring Initializr&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;&lt;a href=&quot;https://thorntail.io/generator/&quot;&gt;Thorntail Project Generator&lt;/a&gt;&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Sharing Host File with Container</title>
      <link>https://guntherrotsch.github.io/blog_2020/file-sharing-with-container.html</link>
      <pubDate>Tue, 9 Jun 2020 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">blog_2020/file-sharing-with-container.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Eclipse Theia is the code editor integrated into Eclipse Che, which calls itself as &lt;a href=&quot;https://www.eclipse.org/che/&quot;&gt;The Kubernetes-Native IDE for Developer Teams&lt;/a&gt;. There are different ways to execute Eclipse Theia independent of Eclipse Che as described by the article &lt;a href=&quot;https://eclipsesource.com/de/blogs/2019/09/25/how-to-launch-eclipse-theia/&quot;&gt;How to launch Eclipse Theia&lt;/a&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_sharing_files_between_host_and_container&quot;&gt;Sharing files between host and container&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Starting Eclipse Theia in a pre-configured Docker container prevents you from complex installation procedures. As mentioned on the Eclipse Theia IDE Github repository, executing the IDE is as easy as submitting the command:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ docker run -it --init -p 3000:3000 \
             -v &quot;$(pwd):/home/project:cached&quot; \
             theiaide/theia-java:next&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;admonitionblock note&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
      &lt;td class=&quot;content&quot;&gt; As Java developer I went for the Java flavored IDE, but other languages are available, too. &lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The &lt;code&gt;-v&lt;/code&gt; option of the Docker run command maps the current working directory &lt;code&gt;$(pwd)&lt;/code&gt; to the &lt;code&gt;/home/project&lt;/code&gt; directory, where the IDE expects the workspace files. In this case, the host files are shared with the container, ie. we &lt;a href=&quot;https://docs.docker.com/storage/bind-mounts/&quot;&gt;use bind mounts&lt;/a&gt;. Although, the preferred mechanism for persisting data with Docker is to &lt;a href=&quot;https://docs.docker.com/storage/volumes/&quot;&gt;use volumes&lt;/a&gt;, the utilization of bind mounts is fine here.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When I started the Theia container from the root directory of an existing Maven project, the IDE can be opened in the Browser on &lt;code&gt;&lt;a href=&quot;http://localhost:3000&quot; class=&quot;bare&quot;&gt;http://localhost:3000&lt;/a&gt;&lt;/code&gt;:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;imageblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;img src=&quot;https://guntherrotsch.github.io/assets/img/Eclipse_Theia.png&quot; alt=&quot;Image: Eclipse Theia Workspace&quot;&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The terminal integrated in the IDE runs a shell in the container of the IDE. There the files of the workspace are listed using the &lt;code&gt;ls&lt;/code&gt; command. The file’s owner are reported as &lt;code&gt;node&lt;/code&gt;. However, the Maven build in IDE’s terminal fails with:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;[ERROR] Failed to execute goal org.apache.maven.plugins:maven-clean-plugin:3.1.0:clean (default-clean) on project bean-validation: Failed to clean project: Failed to delete /home/project/target/generated-test-sources/test-annotations -&amp;gt; [Help 1]: value&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Maven build cannot remove the &lt;code&gt;target&lt;/code&gt; folder, because the container runs with the user &lt;code&gt;theia&lt;/code&gt;, which is apparently not the owner of the files:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;theia@466d3953d9e1:/home/project$ id
uid=1001(theia) gid=1001(theia) groups=1001(theia)&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;What’s also a bit confusing at the first glance is that the shell on the host system reports the very same files to be owned by my personal user &lt;code&gt;gunther&lt;/code&gt;:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ ls -al
total 40
drwxrwxr-x  5 gunther gunther 4096 Mai 24 12:04 .
drwxrwxr-x  4 gunther gunther 4096 Mai 20 20:00 ..
-rw-r--r--  1 gunther gunther 1504 Apr 10 13:53 .classpath
-rw-rw-r--  1 gunther gunther 4680 Mai 24 12:04 pom.xml
-rw-r--r--  1 gunther gunther  544 Apr 10 12:26 .project
-rw-rw-r--  1 gunther gunther  261 Apr 13 12:43 README.txt
drwxr-xr-x  2 gunther gunther 4096 Apr 10 12:26 .settings
drwxrwxr-x  4 gunther gunther 4096 Dez 17 18:29 src
drwxr-xr-x 10 gunther gunther 4096 Mai 24 11:49 target&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;To break things up: The file permission is checked by the Linux kernel. The kernel does not know anything about user names, but works with user IDs only. The &lt;code&gt;/etc/passwd&lt;/code&gt; file or LDAP integration or a similar mechanism takes care of mapping the user IDs to names. That explains why the &lt;code&gt;ls&lt;/code&gt; command reports different user names as owner of shared files inside and outside of the container. The user &lt;code&gt;gunther&lt;/code&gt; on the host system does have the same ID as the user &lt;code&gt;node&lt;/code&gt; in the Theia container:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ id
uid=1000(gunther) gid=1000(gunther) groups=1000(gunther),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),118(lpadmin),129(sambashare),999(microk8s),1001(docker)&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Another fact to keep is mind is that the Linux kernel is shared between the host and all containers. That’s, by the way, one big difference to virtual machines.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;If we want to fix the permissions, so that user running the container owns the shared file of the workspace, we could add the &lt;code&gt;-u&lt;/code&gt; option when starting the container as follows:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;docker run -it --rm --init -p 3000:3000 \
           -u $UID:$(id -g) \
           -v &quot;$(pwd):/home/project:cached&quot; \
           theiaide/theia-java:next&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Now the container runs with user ID &lt;code&gt;1000&lt;/code&gt;, the same ID as the user &lt;code&gt;gunther&lt;/code&gt; on the host system:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;node@11e14537a344:/home/project$ id
uid=1000(node) gid=1000(node) groups=1000(node)&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;As mentioned before, the name of the user does not matter, only its ID counts. The Maven build in the IDE’s terminal, ie. executed by the container, runs successful now.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;admonitionblock warning&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-warning&quot; title=&quot;Warning&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
      &lt;td class=&quot;content&quot;&gt; After changing the user ID of the container, Eclipse Theia IDE does not work properly anymore. Other files inside the container are not longer readable or writable. Though, changing the container’s user is not a sustainable solution to share Theia workspaces with the host. &lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;File permissions are checked by the Linux kernel based on the user’s id, never considering the name of the user which belongs to the ID. Starting containers with a certain user ID can fix file permission issues, but often cause issues when containers expect to run under a particular user ID.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_links&quot;&gt;Links&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&lt;a href=&quot;https://github.com/eclipse-theia/theia&quot;&gt;Github - Eclipse Theia&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&lt;a href=&quot;https://www.eclipse.org/che/&quot;&gt;Project - Eclipse Che&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&lt;a href=&quot;https://docs.docker.com/storage/bind-mounts/&quot;&gt;Docker - Use bind mounts&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&lt;a href=&quot;https://docs.docker.com/storage/volumes/&quot;&gt;Docker - Use volumes&lt;/a&gt;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&lt;a href=&quot;https://eclipsesource.com/de/blogs/2019/09/25/how-to-launch-eclipse-theia/&quot;&gt;Blog Post - How to launch Eclipse Theia&lt;/a&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Cloud-native Java</title>
      <link>https://guntherrotsch.github.io/blog_2020/containerized-java-app.html</link>
      <pubDate>Sun, 17 May 2020 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">blog_2020/containerized-java-app.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Migrating to the cloud by just replacing machines of the own data-center by virtual machines in the cloud, does not provide much benefit, neither regarding costs nor in terms of administration effort. Therefor, the utilization of container orchestration platforms like Kubernetes or OpenShift is assumed in the following - if not even talking about FaaS or Serverless, the latest hype in cloud technologies.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Container orchestration platforms works best for MicroService architectures, ie. the shift to the cloud may have impact on the application architecture. Because this blog post wants to focus on the Java platform for cloud deployments, applications are assumed to be designed in a service-oriented way already.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_competitors&quot;&gt;Competitors&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When making a technology decision for cloud-native applications, it’s worth to start with a look at the first-class citizen of cloud application, the Golang platform. The features that make Golang stand out are speed and size - speed in terms of start-up and execution, size in terms of image size and memory requirements at runtime.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The classical Java EE environments are typically based on an application server and optimized for long-running applications, running on large servers. For such deployments start-up time and memory requirements are not that important.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_building_images&quot;&gt;Building Images&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;One advice for building production-ready container images for Golang applications is to create the images &lt;code&gt;FROM scratch&lt;/code&gt;, ie. don’t base the image of a Linux distribution. The main reason for this is not to reduce the image size, but to reduce the attack surface, which greatly improves security.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Can we do the same for Java applications? Unfortunately not, because the JDK isn’t statically linked like Golang applications are, but dynamically linked against &lt;code&gt;glibc&lt;/code&gt; or &lt;code&gt;musl&lt;/code&gt; library. These libraries are typically part of a Linux distribution.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;For a small demo application, I used the &lt;a href=&quot;https://thorntail.io/generator/&quot;&gt;Thorntail generator&lt;/a&gt; and selected the technologies &lt;code&gt;JAX-RS + CDI + JSON-B&lt;/code&gt;. After extracting the downloaded ZIP file to a folder the application can be started locally with&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;literalblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre&gt;mvn thorntail:run&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When the application server is ready the application can be used:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;gunther@gunther-K501UQ:~/Downloads$ curl localhost:8080/hello -v
*   Trying 127.0.0.1:8080...
* TCP_NODELAY set
* Connected to localhost (127.0.0.1) port 8080 (#0)
&amp;gt; GET /hello HTTP/1.1
&amp;gt; Host: localhost:8080
&amp;gt; User-Agent: curl/7.68.0
&amp;gt; Accept: */*
&amp;gt;
* Mark bundle as not supporting multiuse
&amp;lt; HTTP/1.1 200 OK
&amp;lt; Connection: keep-alive
&amp;lt; Content-Type: text/plain;charset=UTF-8
&amp;lt; Content-Length: 21
&amp;lt; Date: Sat, 02 May 2020 13:36:50 GMT
&amp;lt;
* Connection #0 to host localhost left intact
Hello from Thorntail!gunther@gunther-K501UQ:~/Downloads$
gunther@gunther-K501UQ:~/Downloads$&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The best you can do to keep the image lean is to use the OpenJDK linked against the &lt;code&gt;musl&lt;/code&gt; library. That’s the case for Alpine Linux, a distribution tailored for cloud environments. After building the application with &lt;code&gt;mvn clean install&lt;/code&gt;, the demo application can be packaged into an image by using the following &lt;code&gt;Dockerfile&lt;/code&gt;:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;FROM openjdk:14-jdk-alpine

COPY target/demo-thorntail.jar /app/demo-thorntail.jar

EXPOSE 8080

CMD [&quot;java&quot;, &quot;-Djava.net.preferIPv4Stack=true&quot;, &quot;-Djava.net.preferIPv4Addresses=true&quot;, &quot;-jar&quot;, &quot;/app/demo-thorntail.jar&quot;]&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The resulting image size is about 450 MB. The same application packaged into an image with a Wildfly application server gives a size of about 750 MB. That’s clearly shows, that application servers are not appropriate for containerized Java payload. However, compared to about 20 MB, which is the size of a Golang image with the same functionality, the Thorntail image cannot compete.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Additionally, the start-up time of the Java EE application takes - mostly because of classpath scanning and reflection to process JEE annotations - several seconds, while the Golang application is ready to use in some milliseconds.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because classical Java EE applications are not a good fit for cloud-native platforms, several other options arise in the Java world at this time: Eclipse MicroProfile, alternative Java EE packaging like Hammock, Micro Frameworks like Micronaut, Helidon, Spring Fu, Javalin, Spark, Ratpack, Dropwizard or Akka, native images with GraalVM, etc. The approaches to evolve the Java platform to the future could fill books. It’s almost comparable to the situation of the JavaScript world a few years ago: Lots of different frameworks with unclear future. If you go for a framework today, you might end up with a unsupported platform in a few years. Eg. the Thorntail framework, although just about 4 years old (including the life-time of its successor Wildfly Swarm), is pretty much dead (see &lt;a href=&quot;https://thorntail.io/posts/thorntail-community-announcement-on-quarkus&quot;&gt;Thorntail Community Announcement on Quarkus&lt;/a&gt;).&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The situation today is a bit ambivalent: Java is the undisputed number one programming language and platform, but not well suited for cloud native runtime environments. On the other hand everybody moves from classical on-premises servers to cloud platforms.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because of the diversity of Java frameworks future-proof technical decisions are hard today. The best you can do from my point of view is to stay as close to JEE standards as possible. That’s the reason I’ll surely have a look at Quarkus in the near future.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>OpenApi generated JAX/RS Service: Bean Validation</title>
      <link>https://guntherrotsch.github.io/blog_2020/openapi-bean-validation.html</link>
      <pubDate>Sun, 19 Apr 2020 00:00:00 +0200</pubDate>
      <guid isPermaLink="false">blog_2020/openapi-bean-validation.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_introduction&quot;&gt;Introduction&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Implementing JAX/RS REST APIs with OpenApi following a Design-First approach starts with the formal specification of the REST API. The OpenAPI generators are used to create server stubs as well as client API code. For Java JAX/RS generated servers, the request model classes already contain validations in form of JSR 380 annotations like &lt;code&gt;@NotNull&lt;/code&gt;. But because of limitations in validation specification with OpenAPI or gaps of the code generators, more often than not, validation rules need to be added to the generated model classes.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sidebarblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;div class=&quot;title&quot;&gt;
     JSR 380
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;Jakarta EE 8 includes the version 2.0 of JSR 380, the &lt;em&gt;Bean Validation&lt;/em&gt; standard for checking validity of model objects. The bean validation is mainly applied to request parameters and persisted entity objects.&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;Bean Validation standardizes constraint definition, declaration and validation for the Java platform. Its first two incarnations have been widely popular amongst the Java community in both, SE and EE environments. Integrations with many other specifications (CDI, JAX-RS, JPA, etc.) and frameworks have been created.&lt;/p&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;I’d like illustrate the issue and possible solutions of extending the request object validation for REST APIs by a simplified, yet realistic example. You’ll find the sample project in the folder &lt;code&gt;bean-validation&lt;/code&gt; of the &lt;a href=&quot;https://github.com/GuntherRotsch/guntherrotsch.github.io/tree/code&quot;&gt;code branch of the Blog repository&lt;/a&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;admonitionblock note&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
      &lt;td class=&quot;content&quot;&gt; The sample application is packaged as web application (WAR file) and for tests deployed to a Wildfly 19 application server. &lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_example&quot;&gt;Example&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Let’s say, you’re going to define a REST API to manage &lt;em&gt;Ranges&lt;/em&gt; defined by a minimum and maximum integer values. The following OpenAPI snippet defines the &lt;code&gt;Range&lt;/code&gt; object:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-yaml hljs&quot; data-lang=&quot;yaml&quot;&gt;  components:
    schemas:
      Range:
        properties:
          min:
            type: &quot;integer&quot;
            minimum: 1
            maximum: 1000
          max:
            type: &quot;integer&quot;
            minimum: 1
            maximum: 1000&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The OpenAPI generator &lt;strong&gt;Java JAX/RS spec&lt;/strong&gt; creates the following model class from the specification:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;public class Range   {

  private @Valid Integer min;
  private @Valid Integer max;

  /**
   * minimum: 1
   * maximum: 1000
   **/
  public Range min(Integer min) {
    this.min = min;
    return this;
  }

  @ApiModelProperty(value = &quot;&quot;)
  @JsonProperty(&quot;min&quot;)
  @Min(1) @Max(1000)  public Integer getMin() {
    return min;
  }
  public void setMin(Integer min) {
    this.min = min;
  }

  /**
   * minimum: 1
   * maximum: 1000
   **/
  public Range max(Integer max) {
    this.max = max;
    return this;
  }

  @ApiModelProperty(value = &quot;&quot;)
  @JsonProperty(&quot;max&quot;)
  @Min(1) @Max(1000)  public Integer getMax() {
    return max;
  }
  public void setMax(Integer max) {
    this.max = max;
  }

  @Override
  public boolean equals(java.lang.Object o) {
    if (this == o) {
      return true;
    }
    if (o == null || getClass() != o.getClass()) {
      return false;
    }
    Range range = (Range) o;
    return Objects.equals(this.min, range.min) &amp;amp;&amp;amp;
        Objects.equals(this.max, range.max);
  }

  @Override
  public int hashCode() {
    return Objects.hash(min, max);
  }

  @Override
  public String toString() {
    StringBuilder sb = new StringBuilder();
    sb.append(&quot;class Range {\n&quot;);

    sb.append(&quot;    min: &quot;).append(toIndentedString(min)).append(&quot;\n&quot;);
    sb.append(&quot;    max: &quot;).append(toIndentedString(max)).append(&quot;\n&quot;);
    sb.append(&quot;}&quot;);
    return sb.toString();
  }

  /**
   * Convert the given object to string with each line indented by 4 spaces
   * (except the first line).
   */
  private String toIndentedString(java.lang.Object o) {
    if (o == null) {
      return &quot;null&quot;;
    }
    return o.toString().replace(&quot;\n&quot;, &quot;\n    &quot;);
  }
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;As you can see, the generated model class already contains Bean Validation annotations like &lt;code&gt;@Min&lt;/code&gt; and &lt;code&gt;@Max&lt;/code&gt;. Because JAX/RS integrates with Bean Validation this annotations are considered when the also generated API classes are called. Such a API class may be a POST to create a new &lt;code&gt;Range&lt;/code&gt; resource:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-yaml hljs&quot; data-lang=&quot;yaml&quot;&gt;  paths:
    /range:
      post:
        operationId: newRange
        requestBody:
          required: true
          content:
            application/json:
              schema:
                $ref: &apos;#/components/schemas/Range&apos;
        responses:
          201:
            description: &quot;Range resource created successfully&quot;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Without any manually written code the deployed service responds with HTTP status 400 (Bad Request) when called with a &lt;code&gt;Range&lt;/code&gt; object, that violates one of the bean validation rules. The following &lt;code&gt;curl&lt;/code&gt; statement illustrates the generated API:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ curl localhost:8080/bean-validation/range -d &apos;{ &quot;min&quot;: 0, &quot;max&quot;: 1 }&apos; \
      -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/json&quot; -o - \
 | jq
...
{
  &quot;exception&quot;: null,
  &quot;fieldViolations&quot;: [],
  &quot;propertyViolations&quot;: [],
  &quot;classViolations&quot;: [],
  &quot;parameterViolations&quot;: [
    {
      &quot;constraintType&quot;: &quot;PARAMETER&quot;,
      &quot;path&quot;: &quot;newRange.arg0.min&quot;,
      &quot;message&quot;: &quot;must be greater than or equal to 1&quot;,
      &quot;value&quot;: &quot;0&quot;
    }
  ],
  &quot;returnValueViolations&quot;: []
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Up to this point everything seems to be fine. But we miss an important validation rule: The provided minimum value has to be equal or smaller than the maximum contained in the request. Unfortunately, such a rule can neither expressed by an OpenAPI specification nor considered by any generator available. This basically applies to all validations taking multiple fields of a class into account. But how do we implement such validations?&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_requirements&quot;&gt;Requirements&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Before we discuss different implementation options, let’s list the requirements of request validation from a API user’s point of view:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;olist arabic&quot;&gt; 
   &lt;ol class=&quot;arabic&quot;&gt; 
    &lt;li&gt; &lt;p&gt;Validation rule violations should be reported the same way as JSR 380 detected violations, ie. no mix of JSR 380 and application formatted violation reports.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;The violation report returned by the application server should consider the &lt;code&gt;Accept&lt;/code&gt; header given by the client, ie. as shown in example above, if the request contains a header &lt;code&gt;Accept: application/json&lt;/code&gt;, the response should be in JSON format.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Invalid requests should create a response containing &lt;strong&gt;all&lt;/strong&gt; violated rules. It’s not reasonable for a user if &lt;strong&gt;some&lt;/strong&gt; violations are reported, fixed by the user and on the next request &lt;strong&gt;some other&lt;/strong&gt; violations get reported - such behavior is rather annoying.&lt;/p&gt; &lt;/li&gt; 
   &lt;/ol&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The listed requirements are far from being complete and focus more on the reporting of validation rule violation, the area relating to REST API and affecting the API’s user mostly.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;With the requirements in mind, some implementation ideas appear immediately as insufficient:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Changing generated code is generally not an option, because after re-generation the manual changes are overwritten and get lost.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Because of the individual nature of the validation rules, adapting the code generator, eg. with custom templates, don’t look promising.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;Moving validation checks into the business code would ignore most of the requirements listed above.&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_cdi_based_solution&quot;&gt;CDI based Solution&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;One design pattern I’ve seen in professional projects is based on the fact, that Bean Validation is not only integrated with JAX/RS, but also with CDI. For the range sample the implementation of this pattern requires the definition of a wrapper class around the &lt;code&gt;Range&lt;/code&gt; object, that implements the additional validation as JSR 380 rule:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;public class ValidateableRange {

	private final Range range;

	public ValidateableRange(Range range) {
		this.range = range;
	}

	@Valid
	public Range getRange() {
		return range;
	}

	@AssertTrue(message = &quot;min must be less than or equal to max&quot;)
	public boolean isMinLessThanOrEqualToMax() {
		return range.getMin() &amp;lt;= range.getMax();
	}
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In addition, a &lt;em&gt;validator&lt;/em&gt; CDI bean is required:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;@ApplicationScoped
public class ApplicationValidator {

	public void validate(@Valid ValidateableRange validateableRange) {
		// no-op
	}
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Please note, that the &lt;em&gt;validator&lt;/em&gt; can contain several validation methods for different objects, that need to be validated. Please also note, that the validation method is empty. The &lt;code&gt;@Valid&lt;/code&gt; annotation attached to the method argument is the crucial piece, that triggers the Bean Validation when the method is called.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Given these classes, the validation can be triggered before the actual processing of the request is started:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;@Inject ApplicationValidator appValidator;

public Response newRange(Range range) {
  appValidator.validate(new ValidateableRange(range));

  // business logic goes here
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The implementation of this pattern satisfies all requirements, but the 3rd one: Request validation is performed two times, first when the request enters the JAX/RS API method and second when the &lt;code&gt;ApplicationValidator&lt;/code&gt; enters the stage. Because the &lt;code&gt;ApplicationValidator&lt;/code&gt; performs additional checks, invalid requests fixed by the user may report more violations when called the second time.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;There are more problems with this pattern:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Some validation may be checked twice. That can become problematic when checking the validation rules is rather &lt;em&gt;expensive&lt;/em&gt; in terms of resource consumption/performance.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;The reported objects may be of type &lt;code&gt;ValidateableRange&lt;/code&gt;, although, the API user requested a &lt;code&gt;Range&lt;/code&gt; object.&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;However, for many projects, in particular for internal APIs, the behavior implemented by this CDI based validation pattern is sufficient. In addition, it’s entirely based on Java code and therefor very flexible.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;But if you offer a public REST API, the requirements of API consistency and quality may be higher, also in terms of request validation.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_general_jaxrs_solution&quot;&gt;General JAX/RS Solution&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;To satisfy all requirements listed above, the solution need to be based on JAX/RS and Bean Validation solely. The question is, how should this be done when the JAX/RS resources are generated and not easy modifiable?&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;To begin, let’s ignore the fact, that some code is generated. A class&apos; validation rule like the sample above &lt;em&gt;min must be less or equal to max&lt;/em&gt;, can be implemented:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;ulist&quot;&gt; 
   &lt;ul&gt; 
    &lt;li&gt; &lt;p&gt;Generically with a &lt;code&gt;@AssertTrue&lt;/code&gt; (or &lt;code&gt;@AssertFalse&lt;/code&gt;) annotated method like in &lt;code&gt;ValidatebleRange&lt;/code&gt; example above.&lt;/p&gt; &lt;/li&gt; 
    &lt;li&gt; &lt;p&gt;More specific with a custom validator, that can be associated by a custom annotation to the model class to be validated.&lt;/p&gt; &lt;/li&gt; 
   &lt;/ul&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because the generic solution would require the modification of the generated code, let’s have a look at the second option. Therefor a validator as well as a annotation like the following are needed in our &lt;em&gt;range&lt;/em&gt; sample:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;public class RangeValidator implements ConstraintValidator&amp;lt;CheckMinLessOrEqualMax, Range&amp;gt; {

	public void initialize(CheckMinLessOrEqualMax arg0) {
	}

	public boolean isValid(Range range, ConstraintValidatorContext context) {
		return range.getMin() &amp;lt;= range.getMax();
	}
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;@Target({ FIELD, METHOD, PARAMETER, ANNOTATION_TYPE, TYPE_USE })
@Retention(RUNTIME)
@Constraint(validatedBy = RangeValidator.class)
@Documented
public @interface CheckMinLessOrEqualMax {
	String message() default &quot;{net.gunther.jee.beansvalidation.xml.RangeValidator.&quot; + &quot;message}&quot;;

	Class&amp;lt;?&amp;gt;[] groups() default {};

	Class&amp;lt;? extends Payload&amp;gt;[] payload() default {};
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The defined &lt;code&gt;RangeValidator&lt;/code&gt; is typically attached to the objects of range &lt;code&gt;Range&lt;/code&gt; by annotating this class with &lt;code&gt;@CheckMinLessOrEqualMax&lt;/code&gt;. Because the &lt;code&gt;Range&lt;/code&gt; class is a generated API model class, this is not possible. However, like most Jakarta EE APIs, beside annotations, XML deployment descriptor are supported for configuration of the API’s objects or beans. For our example we just create a &lt;code&gt;META-INF/validation.xml&lt;/code&gt; deployment descriptor to activate custom Bean Validation configurations:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;validation-config
	xmlns=&quot;http://xmlns.jcp.org/xml/ns/validation/configuration&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/validation/configuration
            http://xmlns.jcp.org/xml/ns/validation/configuration/validation-configuration-2.0.xsd&quot;
	version=&quot;2.0&quot;&amp;gt;

	&amp;lt;default-provider&amp;gt;org.hibernate.validator.HibernateValidator&amp;lt;/default-provider&amp;gt;
	&amp;lt;message-interpolator&amp;gt;org.hibernate.validator.messageinterpolation.ParameterMessageInterpolator&amp;lt;/message-interpolator&amp;gt;
	&amp;lt;constraint-mapping&amp;gt;META-INF/validation/constraints-range.xml&amp;lt;/constraint-mapping&amp;gt;
&amp;lt;/validation-config&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;This deployment descriptor references a &lt;code&gt;META-INF/validation/constraints-range.xml&lt;/code&gt; file, that eventually attaches the custom annotation &lt;code&gt;CheckMinLessOrEqualMax&lt;/code&gt; to the &lt;code&gt;Range&lt;/code&gt; model class:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;constraint-mappings
	xmlns=&quot;http://xmlns.jcp.org/xml/ns/validation/mapping&quot;
	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;
	xsi:schemaLocation=&quot;http://xmlns.jcp.org/xml/ns/validation/mapping
            http://xmlns.jcp.org/xml/ns/validation/mapping/validation-mapping-2.0.xsd&quot;
	version=&quot;2.0&quot;&amp;gt;

	&amp;lt;default-package&amp;gt;net.gunther.blog.codegen.models&amp;lt;/default-package&amp;gt;

	&amp;lt;bean class=&quot;Range&quot; ignore-annotations=&quot;false&quot;&amp;gt;
		&amp;lt;class&amp;gt;
			&amp;lt;constraint annotation=&quot;net.gunther.jee.beansvalidation.xml.CheckMinLessOrEqualMax&quot;&amp;gt;
				&amp;lt;message&amp;gt;min must be less than or equal to max&amp;lt;/message&amp;gt;
			&amp;lt;/constraint&amp;gt;
		&amp;lt;/class&amp;gt;
	&amp;lt;/bean&amp;gt;

&amp;lt;/constraint-mappings&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;With that in place, the request validation satisfies all requirements listed above:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ curl localhost:8080/bean-validation/range -d &apos;{ &quot;min&quot;: 1001, &quot;max&quot;: 0 }&apos; \
       -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/json&quot; -o - -v \
     | jq
...
&amp;gt; POST /bean-validation/range HTTP/1.1
&amp;gt; Host: localhost:8080
&amp;gt; User-Agent: curl/7.65.3
&amp;gt; Content-Type: application/json
&amp;gt; Accept: application/json
...
&amp;gt;
...
&amp;lt; HTTP/1.1 400 Bad Request
&amp;lt; validation-exception: true
&amp;lt; Content-Type: application/json
...

{
  &quot;exception&quot;: null,
  &quot;fieldViolations&quot;: [],
  &quot;propertyViolations&quot;: [],
  &quot;classViolations&quot;: [],
  &quot;parameterViolations&quot;: [
    {
      &quot;constraintType&quot;: &quot;PARAMETER&quot;,
      &quot;path&quot;: &quot;newRange.arg0.max&quot;,
      &quot;message&quot;: &quot;must be greater than or equal to 1&quot;,
      &quot;value&quot;: &quot;0&quot;
    },
    {
      &quot;constraintType&quot;: &quot;PARAMETER&quot;,
      &quot;path&quot;: &quot;newRange.arg0.min&quot;,
      &quot;message&quot;: &quot;must be less than or equal to 1000&quot;,
      &quot;value&quot;: &quot;1001&quot;
    },
    {
      &quot;constraintType&quot;: &quot;PARAMETER&quot;,
      &quot;path&quot;: &quot;newRange.arg0&quot;,
      &quot;message&quot;: &quot;min must be less than or equal to max&quot;,
      &quot;value&quot;: &quot;class Range {\n    min: 1001\n    max: 0\n}&quot;
    }
  ],
  &quot;returnValueViolations&quot;: []
}&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The validation is complete, ie. all validation rules are checked, regardless of how they are activated, by annotation or XML deployment descriptor. The validation is entirely based on JSR 380 Bean Validation. Because of the good integration of Bean Validation with JAX/RS, the requested response format is also considered, for example:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ curl localhost:8080/bean-validation/range -d &apos;{ &quot;min&quot;: 1001, &quot;max&quot;: 0 }&apos; \
       -H &quot;Content-Type: application/json&quot; -H &quot;Accept: application/xml&quot; -o - -v \
     | xmllint --format -
...
&amp;gt; POST /bean-validation/range HTTP/1.1
&amp;gt; Host: localhost:8080
&amp;gt; User-Agent: curl/7.65.3
&amp;gt; Content-Type: application/json
&amp;gt; Accept: application/xml
...
&amp;lt; HTTP/1.1 400 Bad Request
&amp;lt; validation-exception: true
&amp;lt; Content-Type: application/xml;charset=UTF-8
...

&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; standalone=&quot;yes&quot;?&amp;gt;
&amp;lt;violationReport&amp;gt;
  &amp;lt;parameterViolations&amp;gt;
    &amp;lt;constraintType&amp;gt;PARAMETER&amp;lt;/constraintType&amp;gt;
    &amp;lt;path&amp;gt;newRange.arg0&amp;lt;/path&amp;gt;
    &amp;lt;message&amp;gt;min must be less than or equal to max&amp;lt;/message&amp;gt;
    &amp;lt;value&amp;gt;class Range {
    min: 1001
    max: 0
}&amp;lt;/value&amp;gt;
  &amp;lt;/parameterViolations&amp;gt;
  &amp;lt;parameterViolations&amp;gt;
    &amp;lt;constraintType&amp;gt;PARAMETER&amp;lt;/constraintType&amp;gt;
    &amp;lt;path&amp;gt;newRange.arg0.max&amp;lt;/path&amp;gt;
    &amp;lt;message&amp;gt;must be greater than or equal to 1&amp;lt;/message&amp;gt;
    &amp;lt;value&amp;gt;0&amp;lt;/value&amp;gt;
  &amp;lt;/parameterViolations&amp;gt;
  &amp;lt;parameterViolations&amp;gt;
    &amp;lt;constraintType&amp;gt;PARAMETER&amp;lt;/constraintType&amp;gt;
    &amp;lt;path&amp;gt;newRange.arg0.min&amp;lt;/path&amp;gt;
    &amp;lt;message&amp;gt;must be less than or equal to 1000&amp;lt;/message&amp;gt;
    &amp;lt;value&amp;gt;1001&amp;lt;/value&amp;gt;
  &amp;lt;/parameterViolations&amp;gt;
&amp;lt;/violationReport&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;admonitionblock note&quot;&gt; 
   &lt;table&gt; 
    &lt;tbody&gt;
     &lt;tr&gt; 
      &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
      &lt;td class=&quot;content&quot;&gt; I’ve found XML descriptors also useful in other use cases, when the concerned objects/beans are third-party and not owned by the application project’s team. This is not only true for Bean Validation, but many other Jakarta EE standards. &lt;/td&gt; 
     &lt;/tr&gt; 
    &lt;/tbody&gt;
   &lt;/table&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Any serious application requires the validation of input data. That’s also true for REST APIs, which need to validate the received request objects. The team JAX/RS and Bean Validation offers a lot of possibilities, when it comes to validate the input of REST APIs. Even if the JAX/RS resources and API model classes are generated - in our example with OpenAPI generators - this article demonstrated options to apply mentioned Jakarta EE standards.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;While the CDI based, Java code only solution works well and offers sufficient results for many projects, the solution applying XML deployment descriptors is best from an API’s user point of view. IMHO, there’s rarely a need to mix business code with validation logic and worsen the usability of the API.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>OpenApi generated JAX/RS Service: JAX/RS Context</title>
      <link>https://guntherrotsch.github.io/blog_2020/openapi-jaxrs-context.html</link>
      <pubDate>Mon, 23 Mar 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/openapi-jaxrs-context.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;But, before starting the discussion of the JAX/RS context object related issues, I shortly describe the setup of the &lt;code&gt;openapi-jaxrs&lt;/code&gt; sample project, you’ll find on the &lt;a href=&quot;https://github.com/GuntherRotsch/guntherrotsch.github.io/tree/code&quot;&gt;code branch&lt;/a&gt; of the Blog repository.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_demo_project_setup&quot;&gt;Demo Project Setup&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The prerequisites to run the demo project are Java of version equal or higher 8 and a current version of Maven. The code samples shown in this Blog post use the OpenAPI Maven plugin:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;plugin&amp;gt;
  &amp;lt;groupId&amp;gt;org.openapitools&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;openapi-generator-maven-plugin&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;4.2.3&amp;lt;/version&amp;gt;
&amp;lt;/plugin&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;This plugin integrates very well with Eclipse: Updating the Maven project executes the generator. In addition, the output directory of generated code is automatically added as source folder to the Eclipse project.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The generator places the output directory into the &lt;code&gt;target&lt;/code&gt; folder of the project. This ensures that the code generation is executed for every build and generated code is never put under version control.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The OpenAPI generator plugin supports several kinds of JAX/RS generators, eg. &lt;code&gt;jaxrs-spec&lt;/code&gt;, &lt;code&gt;jaxrs-resteasy&lt;/code&gt;, &lt;code&gt;jaxrs-cxf&lt;/code&gt;. For this Blog post, we’ll use the &lt;code&gt;jaxrs-spec&lt;/code&gt; generator, which produces code that is compliant to the Jakarta EE standard, but does not depend on a particular implementation of this standard. Nowadays the standard APIs support all features typically required in application development, so that implementation specific extensions are rarely required.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The documentation of the &lt;code&gt;jaxrs-spec&lt;/code&gt; generator’s options can be found on the &lt;code&gt;OpenAPITools/openapi-generator&lt;/code&gt; Github repo at &lt;a href=&quot;https://github.com/OpenAPITools/openapi-generator/blob/master/docs/generators/jaxrs-spec.md&quot;&gt;JAX/RS Spec Generator&lt;/a&gt;.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The demo project is configured for the &lt;code&gt;Thorntail&lt;/code&gt; framework, which allows convenient start of the sample application from the command-line by&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;mvn thorntail:run&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;But the classical packaging as &lt;code&gt;war&lt;/code&gt; file and deployment to an Jakarta EE compliant application server is equally possible.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_jaxrs_context&quot;&gt;JAX/RS Context&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The following list enumerates all JAX/RS context objects of the JAX-RS 2.1 specification, ie. types that can be injected using the &lt;code&gt;@Context&lt;/code&gt; annotation:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;    javax.ws.rs.core.Application
    javax.ws.rs.core.HttpHeaders
    javax.ws.rs.core.Request
    javax.ws.rs.core.SecurityContext
    javax.ws.rs.core.UriInfo
    javax.ws.rs.core.Configuration
    javax.ws.rs.container.ResourceContext
    javax.ws.rs.ext.Providers
    javax.ws.rs.sse.Sse
    javax.ws.rs.sse.SseEventSink&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;In addition, the following types are available when the application in deployed to a servlet container:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;    javax.servlet.HttpServletRequest
    javax.servlet.HttpServletResponse
    javax.servlet.ServletConfig
    javax.servlet.ServletContext&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;What makes JAX/RS context objects special is that they can only injected into JAX/RS resources itself, but not into CDI beans, that are injected into the JAX/RS resource objects. If the JAX/RS resources reside in generated code, the context objects are available only if the generator takes them into account.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_interface_only_generation&quot;&gt;Interface-Only Generation&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The easiest solution to make JAX/RS context objects available is to generate interfaces of the JAX/RS resources only. This can achieved by setting the generator’s option&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;  &amp;lt;interfaceOnly&amp;gt;true&amp;lt;/interfaceOnly&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;in the OpenAPI generator plugin of Maven’s &lt;code&gt;pom.xml&lt;/code&gt; file.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The resulting generated code of a simple &lt;em&gt;greeting&lt;/em&gt; service looks then like this:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  Path(&quot;/greeting&quot;)
  @Api(description = &quot;the greeting API&quot;)
  @javax.annotation.Generated(value = &quot;org.openapitools.codegen.languages.JavaJAXRSSpecServerCodegen&quot;, date = &quot;2020-03-23T19:02:54.718784+01:00[Europe/Zurich]&quot;)
  public interface GreetingApi {

      @GET
      @ApiOperation(value = &quot;&quot;, notes = &quot;&quot;, tags={ &quot;misc&quot; })
      @ApiResponses(value = {
          @ApiResponse(code = 200, message = &quot;Returns greeting on success&quot;, response = Void.class),
          @ApiResponse(code = 405, message = &quot;Invalid input&quot;, response = Void.class) })
      Response greet(@QueryParam(&quot;name&quot;)   @ApiParam(&quot;Optional name of person to greet&quot;)  String name);
  }&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;Since only interfaces are generated, the actual implementation must be coded manually, eg.:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  public class GreetingApiImpl implements GreetingApi {

  	private static final Logger LOGGER = LoggerFactory.getLogger(GreetingApiImpl.class);

  	@Context
  	HttpHeaders headers;
  	@Context
  	UriInfo uriInfo;

  	public Response greet(@QueryParam(&quot;name&quot;) @ApiParam(&quot;Optional name of person to greet&quot;) String name) {
  		StringBuilder headersBuilder = new StringBuilder(&quot;Headers:\n&quot;);
  		for (Map.Entry&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; header : headers.getRequestHeaders().entrySet()) {
  			headersBuilder.append(&quot;\t&quot;).append(header.getKey()).append(&quot;: &quot;).append(header.getValue()).append(&quot;\n&quot;);
  		}
  		LOGGER.info(headersBuilder.toString());
  		LOGGER.info(&quot;UriInfo: {}&quot;, uriInfo);

  		return Response.ok(&quot;Hello world&quot;).build();
  	}
  }&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;Because the JAX/RS resource implementation is hand-written, you are free to inject any context object. In the example above, &lt;code&gt;HttpHeaders&lt;/code&gt; and &lt;code&gt;UriInfo&lt;/code&gt; have been added for demo purposes, but any others is possible, too.&lt;/p&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_implementation_generation&quot;&gt;Implementation Generation&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;For some projects it might not be desired or possible to work with interfaces of JAX/RS resource objects. Let’s see what happens when we change the OpenAPI generator to&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;  &amp;lt;interfaceOnly&amp;gt;false&amp;lt;/interfaceOnly&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;First difference to &lt;em&gt;interface only&lt;/em&gt; generation is that the &lt;code&gt;RestApplication&lt;/code&gt; object is now generated and must not longer provided with the application code.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The generate JAX/RS resource now looks like:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  @Path(&quot;/greeting&quot;)
  @Api(description = &quot;the greeting API&quot;)
  @javax.annotation.Generated(value = &quot;org.openapitools.codegen.languages.JavaJAXRSSpecServerCodegen&quot;, date = &quot;2020-03-23T19:06:40.010561+01:00[Europe/Zurich]&quot;)
  public class GreetingApi {

      @GET
      @ApiOperation(value = &quot;&quot;, notes = &quot;&quot;, response = Void.class, tags={ &quot;misc&quot; })
      @ApiResponses(value = {
          @ApiResponse(code = 200, message = &quot;Returns greeting on success&quot;, response = Void.class),
          @ApiResponse(code = 405, message = &quot;Invalid input&quot;, response = Void.class)
      })
      public Response greet(@QueryParam(&quot;name&quot;)   @ApiParam(&quot;Optional name of person to greet&quot;)  String name) {
          return Response.ok().entity(&quot;magic!&quot;).build();
      }
  }&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The API method of the generated class provides an implementation already. You might be tempted to change this implementation to your needs and add the application’s business logic here. However, the class is generated and the next build would overwrite any manual change.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;What can we do about that? Moving the generated class to the developer managed code-base is not an option, because it violates the principle that the code is generated on each build and generated code is never taken under version control. The best would be to customize the generation in a way that the actual business logic gets injected and the JAX/RS API methods just delegate to the injected business services. This idea is based on the integration of JAX/RS and CDI, which allows to inject arbitrary CDI beans into JAX/RS resources.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;sect3&quot;&gt; 
    &lt;h4 id=&quot;_template_customization&quot;&gt;Template Customization&lt;/h4&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;The OpenAPITools/openapi-generator Github repository includes comprising documentation about the customization of &lt;a href=&quot;https://github.com/OpenAPITools/openapi-generator/blob/master/docs/templating.md&quot;&gt;Templates&lt;/a&gt; or even the entire &lt;a href=&quot;https://github.com/OpenAPITools/openapi-generator/blob/master/docs/customization.md&quot;&gt;Generators&lt;/a&gt;.&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;For our purposes the customization of templates is sufficient. After adding the configuration&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;  &amp;lt;templateDirectory&amp;gt;${project.basedir}/src/main/templates&amp;lt;/templateDirectory&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;to the OpenAPI generator plugin, customized Mustache templates can be provided in defined folder.&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;admonitionblock note&quot;&gt; 
     &lt;table&gt; 
      &lt;tbody&gt;
       &lt;tr&gt; 
        &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
        &lt;td class=&quot;content&quot;&gt; The OpenAPI generator processes many template files in a generation run, but only the customized templates need to be hosted in the project’s template directory. The remaining templates will still be retrieved from the set of standard templates of the generator, ie. the custom teplates &lt;em&gt;shadow&lt;/em&gt; the equally named templates of the generator. &lt;/td&gt; 
       &lt;/tr&gt; 
      &lt;/tbody&gt;
     &lt;/table&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;For our use case the injection of the service class need to be added in the &lt;code&gt;api.mustache&lt;/code&gt; template file:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  @Inject {{package}}.services.{{classname}}Impl delegatee;&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;And the delegation to the injected business service need to be added in the &lt;code&gt;apiMethod.mustache&lt;/code&gt; template file:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  public Response {{nickname}}({{#allParams}}{{&amp;gt;queryParams}}{{&amp;gt;pathParams}}{{&amp;gt;headerParams}}{{&amp;gt;bodyParams}}{{&amp;gt;formParams}}{{#hasMore}},{{/hasMore}}{{/allParams}}) {
      return delegatee.{{nickname}}({{#allParams}}{{paramName}}{{#hasMore}}, {{/hasMore}}{{/allParams}});
  }&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;The delegatee, ie. the CDI bean hosting the business logic, looks in its simplest form like:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  package net.gunther.blog.codegen.api.services;

  import javax.ws.rs.core.Response;

  public class GreetingApiImpl {

  	public Response greet(String name) {
  		return Response.ok(&quot;Hello world&quot;).build();
  	}
  }&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;At this point we achieved that the generated JAX/RS resource classes delegate each call to a hand-written service class, that host the actual business logic. The JAX/RS context objects are still unavailable to the application. To solve this last challenge, we introduce a request scoped &lt;em&gt;holder&lt;/em&gt; object of the JAX/RS context:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;@RequestScoped
public class JAXRSContext {

  private UriInfo uriInfo;
  private HttpHeaders httpHeaders;

  public UriInfo getUriInfo() {
	  return uriInfo;
  }

  public void setUriInfo(UriInfo uriInfo) {
	  this.uriInfo = uriInfo;
  }

  public HttpHeaders getHttpHeaders() {
	  return httpHeaders;
  }

  public void setHttpHeaders(HttpHeaders httpHeaders) {
	  this.httpHeaders = httpHeaders;
  }
}&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;admonitionblock note&quot;&gt; 
     &lt;table&gt; 
      &lt;tbody&gt;
       &lt;tr&gt; 
        &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
        &lt;td class=&quot;content&quot;&gt; For sake of simplicity, the sample code limits to &lt;code&gt;HttpHeaders&lt;/code&gt; and &lt;code&gt;UriInfo&lt;/code&gt;, but any other JAX/RS context object can be easily added. Import statements are also omitted. &lt;/td&gt; 
       &lt;/tr&gt; 
      &lt;/tbody&gt;
     &lt;/table&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;Then we add the injection of the JAX/RS context objects and our new holder object to the customized &lt;code&gt;api.mustache&lt;/code&gt; template file:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  ...
  @Context UriInfo uriInfo;
  @Context HttpHeaders httpHeaders;

  @Inject JAXRSContext context;
  ...&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;The injected objects can then be used in the generated API methods, ie. the template &lt;code&gt;apiMethod.mustache&lt;/code&gt; file can further customized by adding:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  public Response {{nickname}}({{#allParams}}{{&amp;gt;queryParams}}{{&amp;gt;pathParams}}{{&amp;gt;headerParams}}{{&amp;gt;bodyParams}}{{&amp;gt;formParams}}{{#hasMore}},{{/hasMore}}{{/allParams}}) {
    context.setUriInfo(uriInfo);
    context.setHttpHeaders(httpHeaders);
    return delegatee.{{nickname}}({{#allParams}}{{paramName}}{{#hasMore}}, {{/hasMore}}{{/allParams}});
  }&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;You may have noted, that we do not add the JAX/RS holder object to the signature of the delegatee’s method. The JAX/RS holder &lt;code&gt;context&lt;/code&gt; is a CDI bean, which is just populated with the JAX/RS context in the generated resource class. Because the bean of type &lt;code&gt;JAXRSContext&lt;/code&gt; is request scoped, every request processing (thread) gets its own instance of the bean.&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;The &lt;code&gt;JAXRSContext&lt;/code&gt; is a regular CDI bean which can be injected into any other CDI bean, eg. the delegatee’s service implementation:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;  public class GreetingApiImpl {

  	private static final Logger LOGGER = LoggerFactory.getLogger(GreetingApiImpl.class);

    @Inject JAXRSContext context;

  	public Response greet(String name) {
  		StringBuilder headersBuilder = new StringBuilder(&quot;Headers:\n&quot;);
  		for (Map.Entry&amp;lt;String, List&amp;lt;String&amp;gt;&amp;gt; header : context.getHttpHeaders().getRequestHeaders().entrySet()) {
  			headersBuilder.append(&quot;\t&quot;).append(header.getKey()).append(&quot;: &quot;).append(header.getValue()).append(&quot;\n&quot;);
  		}
  		LOGGER.info(headersBuilder.toString());
  		LOGGER.info(&quot;UriInfo.absolutePath: {}&quot;, context.getUriInfo().getAbsolutePath());
  		return Response.ok(&quot;Hello world&quot;).build();
  	}
  }&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;When now calling the application the HTTP headers and the absolute path of the requested JAX/RS resource are logged, for example:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;listingblock&quot;&gt; 
     &lt;div class=&quot;content&quot;&gt; 
      &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;2020-03-24 20:45:02,834 INFO  [net.gunther.blog.codegen.api.services.GreetingApiImpl] (default task-1) Headers:
	DNT: [1]
	Accept-Language: [en-US,en;q=0.5]
	Host: [localhost:8080]
	Accept: [text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8]
	User-Agent: [Mozilla/5.0 (X11; Ubuntu; Linux x86_64; rv:74.0) Gecko/20100101 Firefox/74.0]
	Accept-Encoding: [gzip, deflate]
	Upgrade-Insecure-Requests: [1]
	Connection: [keep-alive]
	Cache-Control: [max-age=0]

2020-03-24 20:45:02,836 INFO  [net.gunther.blog.codegen.api.services.GreetingApiImpl] (default task-1) UriInfo.absolutePath: http://localhost:8080/greeting&lt;/code&gt;&lt;/pre&gt; 
     &lt;/div&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;paragraph&quot;&gt; 
     &lt;p&gt;Implementing the &lt;code&gt;JAXRSContext&lt;/code&gt; as request scoped CDI bean has several benefits:&lt;/p&gt; 
    &lt;/div&gt; 
    &lt;div class=&quot;ulist&quot;&gt; 
     &lt;ul&gt; 
      &lt;li&gt; &lt;p&gt;The technical JAX/RS context does not pollute the business interfaces implemented by the service delegates.&lt;/p&gt; &lt;/li&gt; 
      &lt;li&gt; &lt;p&gt;The &lt;code&gt;JAXRSContext&lt;/code&gt; can hold any number of context objects, you can start with just one and add more if you need more in later stages of the development. Adding more context objects means extending the template, but does not break a single line of existing code.&lt;/p&gt; &lt;/li&gt; 
      &lt;li&gt; &lt;p&gt;The &lt;code&gt;JAXRSContext&lt;/code&gt; can be injected into business logic of any level in the call hierarchy, not only in the directly called delegatee.&lt;/p&gt; &lt;/li&gt; 
      &lt;li&gt; &lt;p&gt;The &lt;code&gt;JAXRSContext&lt;/code&gt; is only injected into CDI beans that actually need the context.&lt;/p&gt; &lt;/li&gt; 
     &lt;/ul&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_summary&quot;&gt;Summary&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The simplest approach when it comes to OpenAPI and its generators is to limit the generated code to interfaces. This approach does not require customization of templates and nevertheless leaves any implementation option in your hands.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;If you already generate JAX/RS resource implementations or need to customize the generator’s templates anyway, then the described JAX/RS holder object may be an option for you. Implementing the JAX/RS holder as request scoped CDI bean offers several benefits as listed above.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>JBake, Asciidoc and PlantUML</title>
      <link>https://guntherrotsch.github.io/blog_2020/jbake-asciidoctor-plantuml.html</link>
      <pubDate>Sat, 29 Feb 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/jbake-asciidoctor-plantuml.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;It is really a hype to have everything in version control, namely Git, - and it is always better to version text source than images or binary files. This applies to diagrams, too. With the PlantUML extension Asciidoc offers a way to define diagrams in a declarative way, but include them as images into generated documents, eg. Blog posts like HTML pages.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_configuration&quot;&gt;Configuration&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The use of PlantUML is actually not very difficult to configure. Because my Blog project setup works with JBake’s Maven plugin, we need to add the dependency of &lt;code&gt;jbake-maven-plugin&lt;/code&gt; on the &lt;em&gt;diagram&lt;/em&gt; extension:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-xml hljs&quot; data-lang=&quot;xml&quot;&gt;&amp;lt;dependency&amp;gt;
  &amp;lt;groupId&amp;gt;org.asciidoctor&amp;lt;/groupId&amp;gt;
  &amp;lt;artifactId&amp;gt;asciidoctorj-diagram&amp;lt;/artifactId&amp;gt;
  &amp;lt;version&amp;gt;1.5.18&amp;lt;/version&amp;gt;
&amp;lt;/dependency&amp;gt;&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The diagram extension includes PlantUML.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The next and last step is to set some properties in JBake’s configuration file &lt;code&gt;jbake.properties&lt;/code&gt;:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;asciidoctor.option.requires=asciidoctor-diagram
asciidoctor.attributes=sourceDir=src/main/jbake,imagesdir=assets/img/diagrams,imagesoutdir=../../assets/assets/img/diagrams,source-highlighter=highlight.js,icons=font&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;If you’re interested in the image directory configuration the &lt;a href=&quot;https://guntherrotsch.github.io/blog_2020/non-jekyll-github-pages.html&quot;&gt;Blog post&lt;/a&gt; gives more details.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_usage&quot;&gt;Usage&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;With described configurations in place, UML diagrams can be easily included in Blog posts. The definition:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;[plantuml, &quot;asciidoctor-sequence-diagram&quot;, &quot;png&quot;]
----
Alice -&amp;gt; Bob: Authentication Request
Bob --&amp;gt; Alice: Authentication Response

Alice -&amp;gt; Bob: Another authentication Request
Alice &amp;lt;-- Bob: another authentication Response
----&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;results in the diagram:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;imageblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;img src=&quot;https://guntherrotsch.github.io/assets/img/diagrams/asciidoctor-sequence-diagram.png&quot; alt=&quot;asciidoctor sequence diagram&quot; width=&quot;298&quot; height=&quot;214&quot;&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Because PlantUML includes the &lt;em&gt;Creole&lt;/em&gt; markup engine, which offers the definition of simple &lt;em&gt;tree like&lt;/em&gt; structures, it’s also possible to create diagrams of directory hierarchies for example. The definition:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;[plantuml, &quot;file-system-tree&quot;, &quot;png&quot;, opts=&quot;inline&quot;]
----
@startuml
skinparam {
  BackgroundColor transparent
  BorderColor transparent
}
legend
Root
|_ Element 1
  |_ Element 1.1
    |_ Element 1.1.1
    |_ Element 1.1.2
  |_ Element 1.2
  |_ Element 1.3
|_ Element 2
  |_ Element 2.1
end legend
----&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;renders to:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;imageblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;img src=&quot;https://guntherrotsch.github.io/assets/img/diagrams/file-system-tree.png&quot; alt=&quot;file system tree&quot; width=&quot;164&quot; height=&quot;196&quot;&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>OpenAPI generated JAX/RS Service: Binary Encoding</title>
      <link>https://guntherrotsch.github.io/blog_2020/openapi-jaxrs-encoding-configuration.html</link>
      <pubDate>Mon, 24 Feb 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/openapi-jaxrs-encoding-configuration.html</guid>
      	<description>
	&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;Let’s say an API defines a response model object as follows:&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;listingblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-yaml hljs&quot; data-lang=&quot;yaml&quot;&gt;  ....
definitions:
  SomeResponse:
    type: &quot;object&quot;
        required: &quot;data&quot;
    properties:
      ...
      data:
        description: The binary data of the response object.
        type: &quot;string&quot;
        format: &quot;byte&quot;
  ...&lt;/code&gt;&lt;/pre&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;The code produced by generator &lt;code&gt;jaxrs-spec&lt;/code&gt; encodes the &lt;code&gt;data&lt;/code&gt; field as an array of bytes (numbers). The ASCII string &quot;Java&quot; for example results in an encoded JSON field &lt;code&gt;&quot;data&quot;: [ 112, 141, 166, 141 ]&lt;/code&gt;.&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;On the other side, the generator &lt;code&gt;java&lt;/code&gt; creates client code that encodes such &lt;em&gt;byte strings&lt;/em&gt; of the API spec as base 64 strings. The sample string &quot;Java&quot; results in &lt;code&gt;&quot;data&quot;: &quot;SmF2YQ==&quot;&lt;/code&gt;.&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;Eventually, this leads to a situation, the generated client and server are not compatible and cannot exchange binary data.&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;The simplest approach to fix this issue is by configuring the binary data strategy on the server-side:&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;listingblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code class=&quot;language-java hljs&quot; data-lang=&quot;java&quot;&gt;import javax.json.bind.*;
import javax.ws.rs.ext.*;

/**
 * The JsonbConfigurator configures the binary data strategy of JSON Binding.
 * Instead of the default strategy &quot;byte array&quot; the &quot;base 64&quot; encoding is
 * activated.
 */
@Provider
public class JsonbConfigurator implements ContextResolver&amp;lt;Jsonb&amp;gt; {

  @Override
  public Jsonb getContext(Class&amp;lt;?&amp;gt; type) {
    JsonbConfig config = getJsonbConfig();
    return JsonbBuilder.newBuilder().withConfig(config).build();
  }

  private JsonbConfig getJsonbConfig() {
    return new JsonbConfig().withBinaryDataStrategy(BinaryDataStrategy.BASE_64);
  }
}&lt;/code&gt;&lt;/pre&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;If you add this class to your JAX/RS server project, client and server both encode and decode binary data as base 64 strings and start to work well together. Such a Jakarta EE based solution should definitely preferred over the customization of generator’s templates, in particular if you take long-term maintainability into account.&lt;/p&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Maven Dependecy Analyzis Plugin</title>
      <link>https://guntherrotsch.github.io/blog_2020/maven-dependency-analysis-plugin.html</link>
      <pubDate>Wed, 12 Feb 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/maven-dependency-analysis-plugin.html</guid>
      	<description>
	&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;When implementing an application I usually use the logging facade &lt;code&gt;slf4j&lt;/code&gt;. When double-checking the dependencies of such a project with&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;listingblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn dependency:analyse&lt;/code&gt;&lt;/pre&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;the plugin often reports&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;listingblock&quot;&gt; 
 &lt;div class=&quot;content&quot;&gt; 
  &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;[WARNING] Unused declared dependencies found:
[WARNING]    org.slf4j:slf4j-log4j12:jar:1.7.26:test&lt;/code&gt;&lt;/pre&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;But without declaring the reported &lt;code&gt;slf4j-log4j&lt;/code&gt; as dependency, the tests suppress the log output entirely. The reason for this is that &lt;code&gt;slf4j&lt;/code&gt; logging facade looks up available implementations of the facade interface by reflection. If no implementation like the &lt;code&gt;slf4j-log4j&lt;/code&gt; is found, the &lt;code&gt;no-op&lt;/code&gt; logger is installed and no logging output is generated.&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;paragraph&quot;&gt; 
 &lt;p&gt;But we cannot blame the Maven dependency plugin, because it can only consider dependencies explicitly defined in the POM, and not libraries resolved by reflection.&lt;/p&gt; 
&lt;/div&gt; 
&lt;div class=&quot;admonitionblock note&quot;&gt; 
 &lt;table&gt; 
  &lt;tbody&gt;
   &lt;tr&gt; 
    &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-note&quot; title=&quot;Note&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
    &lt;td class=&quot;content&quot;&gt; The scope of the &lt;code&gt;slf4j-log4j&lt;/code&gt; artifact is just &lt;code&gt;test&lt;/code&gt;, because at runtime the application server provides an appropriate implementation of the logging facade interface. &lt;/td&gt; 
   &lt;/tr&gt; 
  &lt;/tbody&gt;
 &lt;/table&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>Non-Jekyll Github Pages</title>
      <link>https://guntherrotsch.github.io/blog_2020/non-jekyll-github-pages.html</link>
      <pubDate>Sat, 1 Feb 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/non-jekyll-github-pages.html</guid>
      	<description>
	&lt;div id=&quot;preamble&quot;&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;&amp;nbsp;&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Github Pages was originally designed to integrate static site-generator Jekyll. This may still be the most applied combination. But today it’s also possible to generate a static site using a generator of your choice and publish it with Github Pages. Because my Blog is generated with JBake and only distribution files are pushed to &lt;code&gt;master&lt;/code&gt; branch of Github repo, I placed an empty &lt;code&gt;.nojekyll&lt;/code&gt; file into the web root. According to the documentation, this tells Github Pages to skip the Jekyll build and just transfer every file hosted in &lt;code&gt;master&lt;/code&gt; branch to the web server. However, images are still not deployed and the &lt;em&gt;alternative&lt;/em&gt; text is shown instead to the users.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_images&quot;&gt;Images&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The Github Pages documentation mentions, that images should be kept below an &lt;code&gt;assets&lt;/code&gt; folder. This may apply for Jekyll especially, but nevertheless I introduced such a folder and moved the images to &lt;code&gt;/assets/img&lt;/code&gt;. Actually, I ended up with two nested folders named &lt;code&gt;assets&lt;/code&gt; in the sources of the project. JBake removes one of them during &lt;em&gt;baking&lt;/em&gt; of the site, so that the directory structure of the distribution contains only one folder &lt;code&gt;assets&lt;/code&gt; possibly required by Github Pages.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;To clean everything up a bit, the &lt;code&gt;css&lt;/code&gt;, &lt;code&gt;fonts&lt;/code&gt;, and &lt;code&gt;js&lt;/code&gt; folders are also moved below the &lt;code&gt;/assets&lt;/code&gt; directory. This requires adaption of the templates, eg. the &lt;code&gt;header.ftl&lt;/code&gt; has to reference the right stylesheets:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;...
&amp;lt;link href=&quot;&amp;lt;#if (content.rootpath)??&amp;gt;${content.rootpath}&amp;lt;#else&amp;gt;&amp;lt;/#if&amp;gt;assets/css/bootstrap.min.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
&amp;lt;link href=&quot;&amp;lt;#if (content.rootpath)??&amp;gt;${content.rootpath}&amp;lt;#else&amp;gt;&amp;lt;/#if&amp;gt;assets/css/asciidoctor.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
&amp;lt;link href=&quot;&amp;lt;#if (content.rootpath)??&amp;gt;${content.rootpath}&amp;lt;#else&amp;gt;&amp;lt;/#if&amp;gt;assets/css/base.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
&amp;lt;link href=&quot;&amp;lt;#if (content.rootpath)??&amp;gt;${content.rootpath}&amp;lt;#else&amp;gt;&amp;lt;/#if&amp;gt;assets/css/prettify.css&quot; rel=&quot;stylesheet&quot;&amp;gt;
...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;After publishing these changes, the the images embedded in the pages appear as expected.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_pages_in_sub_directories&quot;&gt;Pages in Sub-directories&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The typical directory structure of a JBake project organizes HTML pages as follows:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;/
   ...
   index.html
   ...
   /blog/2020
      first-post.html
      second-post.html
      ...&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The index page is initially presented to the user when he navigates to the web page’s root. From here users may navigate to the individual Blog posts, which are hosted in two level deep sub-directories &lt;code&gt;/blog/&amp;lt;year&amp;gt;&lt;/code&gt;. Though, the Blog post in sub-directories were not deployed and navigation to such pages resulted in 404 (page not found) error pages.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The documentation of Github Pages mentions, that the &lt;code&gt;Checks&lt;/code&gt; tab of the Pull Requests should be observed for detecting issues during the Github/Jekyll build. But I’ve never seen a single message there. May be this applies to &lt;em&gt;pure&lt;/em&gt; Jekyll builds only. In general, I find it hard to get an insight into what happens on Github Pages. To my knowledge, it’t not even possible to get an eye on the actually distributed files hosted by the web server - please drop me an email, if I missed something.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Anyway, to find by trial-and-error out what’s going on during the Github Pages build/deployment, I placed additional &lt;code&gt;index.html&lt;/code&gt; files into the directories &lt;code&gt;/blog&lt;/code&gt; as well as &lt;code&gt;/blog/2020&lt;/code&gt;. Surprisingly, the index page in &lt;code&gt;/blog&lt;/code&gt; could be retrieved by the Browser, but &lt;code&gt;/blog/2020&lt;/code&gt; is missing and leads a 404 (page not found) error page. Does the additional level of directories really makes the difference? That’d be far away from being logical. But after merging the directories &lt;code&gt;/blog/2020&lt;/code&gt; to &lt;code&gt;/blog_2020&lt;/code&gt; and moving the Blog posts into the new directory, the navigation to individual posts works fine, even on Github Pages&apos; deployment.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Actually, my enthusiasm for Github Pages diminished quite a bit. The process of build and deployment could be improved to more transparency in principle. In addition, I initially was not aware of the limitation that personal (and organizational) Github pages can only be served from &lt;code&gt;master&lt;/code&gt; branch’s root directory, but not like project pages from a &lt;code&gt;/docs&lt;/code&gt; folder - the reason for this limitation is not clear to me. (Because of this limitation, I separated sources and distribution files of my project to different branches &lt;code&gt;sources-master&lt;/code&gt; and &lt;code&gt;master&lt;/code&gt;. The local development is then setup with a single Git repo managing two worktrees.)&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;However, I’m still excited about JBake, it’s easy to use and always works as expected. In the meantime, I also adapted several templates, which is understandable and also well documented. JBake, really good stuff.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>
    <item>
      <title>JBake Blog with Maven Plugin</title>
      <link>https://guntherrotsch.github.io/blog_2020/jbake-blog-with-maven.html</link>
      <pubDate>Tue, 21 Jan 2020 00:00:00 +0100</pubDate>
      <guid isPermaLink="false">blog_2020/jbake-blog-with-maven.html</guid>
      	<description>
	&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_preparation&quot;&gt;Preparation&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_java&quot;&gt;Java&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;As of the time of writing, with Java runtime 11 or higher JBake (or one of its dependencies) logged exceptions to the console. At the first glance JBake still seemed to work. But to be on the save side, I usually run JBake with Java in version 8 &lt;sup class=&quot;footnote&quot;&gt;[&lt;a id=&quot;_footnoteref_1&quot; class=&quot;footnote&quot; href=&quot;#_footnotedef_1&quot; title=&quot;View footnote.&quot;&gt;1&lt;/a&gt;]&lt;/sup&gt;.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;admonitionblock tip&quot;&gt; 
    &lt;table&gt; 
     &lt;tbody&gt;
      &lt;tr&gt; 
       &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-tip&quot; title=&quot;Tip&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
       &lt;td class=&quot;content&quot;&gt; I use the nice little tool &lt;a href=&quot;https://github.com/jenv/jenv&quot;&gt;jenv&lt;/a&gt;, that allows to switch between different Java JDK versions easily. If you work on many projects with different Java versions at the same time, you should give &lt;code&gt;jenv&lt;/code&gt; a try, &lt;/td&gt; 
      &lt;/tr&gt; 
     &lt;/tbody&gt;
    &lt;/table&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_github_pages&quot;&gt;Github Pages&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;I decided to publish my Blog on Github pages, which are well suited for statically generated sites. In addition, it’s well integrated with git and by that supports well-known workflows.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;In my case, I created a personal Github Pages site by defining a repository named &lt;code&gt;guntherrotsch.github.io&lt;/code&gt;. Project-specific Github Pages are also possible, but could create links/URLs in some cases, which are not so nice. Please see the &lt;a href=&quot;https://help.github.com/en/github/working-with-github-pages&quot;&gt;Github Pages documentation&lt;/a&gt; for more information on setting up an appropriate repository.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The Github Pages paragraph of the repository settings should after configuration look like:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;imageblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;img src=&quot;https://guntherrotsch.github.io/assets/img/Github_Pages_Setting_Blog.png&quot; alt=&quot;Image: Github Pages Setting&quot;&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The content merged to &lt;code&gt;master&lt;/code&gt; branch will be automatically published (with a short delay of max a few minutes).&lt;/p&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_starting_blog_project&quot;&gt;Starting Blog Project&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;When setting up my Blog, the goal was to utilize JBake by Maven only. So, I wanted to avoid to install JBake explicitly and let Maven handle the download and integration of JBake artifacts.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The most explanations below apply for the JBake Maven Plugin in general, but some are specific for settings I did for my Blog project. Please see the Maven &lt;a href=&quot;https://github.com/GuntherRotsch/guntherrotsch.github.io/blob/master/pom.xml&quot;&gt;pom.xml&lt;/a&gt; of my Blog project. If you also want to start your Blog with Maven and the JBake plugin, you could even copy the POM and adapt it slightly - very few definitions are specific to my Blog project, eg. group and artifact id.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_jbake_maven_plugin&quot;&gt;JBake Maven Plugin&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The JBake Maven Plugin is hosted on &lt;a href=&quot;https://github.com/jbake-org/jbake-maven-plugin&quot;&gt;Github&lt;/a&gt;. There you can find some useful information to start its usage.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;It also helps a lot, that the plugin follows good practices of Maven plugin development and provides a &lt;code&gt;help&lt;/code&gt; goal:&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;listingblock&quot;&gt; 
   &lt;div class=&quot;content&quot;&gt; 
    &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn jbake:help   # -Ddetail=true -Dgoal=[seed|generate|watch|inline]&lt;/code&gt;&lt;/pre&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;The &lt;code&gt;jbake:help&lt;/code&gt; goal gives general information about other goals of the plugin, it provides even more information than the Github page of JBake Maven plugin. The &lt;code&gt;jbake:help&lt;/code&gt; called without additional parameters just lists available goals. In addition, it considers the property System property parameters &lt;code&gt;detail&lt;/code&gt; and &lt;code&gt;goal&lt;/code&gt; (commented out above) to give more detailed information about each plugin’s goal.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;sect2&quot;&gt; 
   &lt;h3 id=&quot;_plugin_goals&quot;&gt;Plugin Goals&lt;/h3&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The most goals of the plugin consider configuration parameters. The most important ones are:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;dlist&quot;&gt; 
    &lt;dl&gt; 
     &lt;dt class=&quot;hdlist1&quot;&gt;
      outputDirectory
     &lt;/dt&gt; 
     &lt;dd&gt; 
      &lt;p&gt;The directory the goals write the generated output.&lt;/p&gt; 
     &lt;/dd&gt; 
     &lt;dt class=&quot;hdlist1&quot;&gt;
      inputDirectory
     &lt;/dt&gt; 
     &lt;dd&gt; 
      &lt;p&gt;The directory the goals read input from. The input directory defaults for the most goals to &lt;code&gt;${project.basedir}/src/main/jbake)&lt;/code&gt;.&lt;/p&gt; 
     &lt;/dd&gt; 
    &lt;/dl&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The easiest way to setup the Blog project is to fetch samples templates and content and populate the Blog project folders. This can be achieved with the &lt;code&gt;jbake:seed&lt;/code&gt; goal.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The &lt;code&gt;jbake:seed&lt;/code&gt; goal is an exception to the default &lt;code&gt;outputDirectory&lt;/code&gt; parameter, because it populates the input directory. If you don’t like to modify the &lt;code&gt;pom.xml&lt;/code&gt; temporarily for the first initialization step and work with a copy of my POM, you can overwrite the output directory on the command-line by defining a Java System property as follows:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn jbake:seed -DoutputDirectory=./src/main/jbake&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;Before we generate the sample static Blog site, you should have a look at the jbake configuration, which is hosted in &lt;code&gt;${project.basedir}/src/main/jbake/jbake.properties)&lt;/code&gt;:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;#site.host=https://guntherrotsch.github.io
site.host=http://localhost:8080
render.tags=false
render.sitemap=true&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;For local testing of the site, I’ve changed the &lt;code&gt;site.host&lt;/code&gt; property temporarily to localhost. JBake uses this parameter to generate the links between the site’s pages, which is quite important.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;admonitionblock warning&quot;&gt; 
    &lt;table&gt; 
     &lt;tbody&gt;
      &lt;tr&gt; 
       &lt;td class=&quot;icon&quot;&gt; &lt;i class=&quot;fa icon-warning&quot; title=&quot;Warning&quot;&gt;&lt;/i&gt; &lt;/td&gt; 
       &lt;td class=&quot;content&quot;&gt; Don’t forget to change the &lt;code&gt;site.host&lt;/code&gt; to you Github Pages URL before you commit and push the project files to Github. The commented out first line shows the definition for my Blog site’s URL. &lt;/td&gt; 
      &lt;/tr&gt; 
     &lt;/tbody&gt;
    &lt;/table&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The &lt;code&gt;jbake:generate&lt;/code&gt; goal applies the project’s templates to the content files and generates the static site:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn jbake:generate&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;My project POM already defines input and output configuration parameters properly. If you want to have a look at the generated site you can either serve it by a local Web server, e.g. by executing &lt;code&gt;python3 -m http.server&lt;/code&gt; in the site’s root folder, or use the &lt;code&gt;jbake:inline&lt;/code&gt; goal, that starts JBake’s internal Web server:&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;listingblock&quot;&gt; 
    &lt;div class=&quot;content&quot;&gt; 
     &lt;pre class=&quot;highlightjs highlight&quot;&gt;&lt;code&gt;$ mvn jbake:inline [ -Dport=8000 ]&lt;/code&gt;&lt;/pre&gt; 
    &lt;/div&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The JBake’s internal Web server listens by default on port &lt;code&gt;8080&lt;/code&gt;. If you have another application occupying port &lt;code&gt;8080&lt;/code&gt;, then the listening port of JBake can be changed with the &lt;code&gt;port&lt;/code&gt; parameter.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;The &lt;code&gt;jbake:inline&lt;/code&gt; watches for changes of templates and content in the source folder and re-generates the static site if any modified file is detected. After refreshing the page in the browser you see the changes without explicitly generating the static site again, which is very nice for a workflow. So, it’s worth considering usage of JBake’s internal Web server, even if you are used to another local Web server.&lt;/p&gt; 
   &lt;/div&gt; 
   &lt;div class=&quot;paragraph&quot;&gt; 
    &lt;p&gt;You can now navigate with your favorite Browser to &lt;code&gt;&lt;a href=&quot;http://localhost:8080&quot; class=&quot;bare&quot;&gt;http://localhost:8080&lt;/a&gt;&lt;/code&gt; to have a look at the sample content. After replacing the samples with your own content and merging the changed files to &lt;code&gt;master&lt;/code&gt; branch of your Blog project, Github Pages takes automatically care of publishing your site. Congratulations, your Blog is up and running.&lt;/p&gt; 
   &lt;/div&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div class=&quot;sect1&quot;&gt; 
 &lt;h2 id=&quot;_conclusion&quot;&gt;Conclusion&lt;/h2&gt; 
 &lt;div class=&quot;sectionbody&quot;&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;I’m really happy to have selected JBake as static site generator when I started blogging. The Java tooling feels familiar for me and JBake’s features are absolutely satisfying - I appreciate the Asciidoc support in particular.&lt;/p&gt; 
  &lt;/div&gt; 
  &lt;div class=&quot;paragraph&quot;&gt; 
   &lt;p&gt;Also, the combination with the Maven plugin works really well. Till today I haven’t installed JBake CLI and let do Maven the job of managing the required JBake dependencies.&lt;/p&gt; 
  &lt;/div&gt; 
 &lt;/div&gt; 
&lt;/div&gt; 
&lt;div id=&quot;footnotes&quot;&gt; 
 &lt;hr&gt; 
 &lt;div class=&quot;footnote&quot; id=&quot;_footnotedef_1&quot;&gt; 
  &lt;a href=&quot;#_footnoteref_1&quot;&gt;1&lt;/a&gt;. Amendment, 18th of February 2020: In the meantime I found out that at least the OrientDB used by Jbake to manage the posts during the build requires Java 8. 
 &lt;/div&gt; 
&lt;/div&gt;
	</description>
    </item>

  </channel> 
</rss>
